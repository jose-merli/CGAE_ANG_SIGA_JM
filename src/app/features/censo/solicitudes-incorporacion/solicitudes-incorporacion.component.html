<p-growl [(value)]="msgs" (onHover)="clear()" life="30000"></p-growl>

<div class="header-title">
    <i class="fa fa-square"></i>
    <p>{{ "menu.censo" | translate}}
        <i class="fa fa-angle-right"></i>{{'censo.solicitudincorporacion' | translate}}
    </p>
</div>
<div class="card">
    <div class="card-body">
        <p class="title-module" (click)="onHideCard()">
            <span>{{'censo.solicitudincorporacion' | translate}}</span>
            <i *ngIf="showCard" class="fa fa-angle-up float-right"></i>
            <i *ngIf="!showCard" class="fa fa-angle-down float-right"></i>
        </p>
        <div *ngIf="showCard" class="module vista-simple">
            <div class="form-row">
                <div class="form-group col-lg-3 col-md-3">
                    <label>{{'censo.solicitudincorporacion.tipoSolicitud' | translate}}</label>
                    <p-dropdown class="select-form" [options]="tiposSolicitud" placeholder="{{'general.boton.seleccionar' | translate}}" [filter]="true"
                        [showClear]="true" filterBy="label,labelSinTilde" [(ngModel)]="body.tipoSolicitud"></p-dropdown>
                </div>
                <div class="form-group col-lg-3 col-md-3">
                    <label>{{'censo.solicitudincorporacion.estadoSolicitud' | translate}}</label>
                    <p-dropdown class="select-form" [options]="estadosSolicitud" placeholder="{{'general.boton.seleccionar' | translate}}" [filter]="true"
                        [showClear]="true" filterBy="label,labelSinTilde" [(ngModel)]="body.estadoSolicitud"></p-dropdown>
                </div>
                <div class="form-group col-lg-3 col-md-3">
                    <label>{{'censo.solicitudincorporacion.fechaDesde' | translate}} (*)</label>
                    <app-fecha [(value)]="body.fechaDesde" [utc]="false" (valueChangeSelected)="fillFechaDesde($event)" (valueChangeInput)="fillFechaDesde($event)"></app-fecha>
                </div>
                <div class="form-group col-lg-3 col-md-3">
                    <label>{{'censo.solicitudincorporacion.fechaHasta' | translate}}</label>
                    <app-fecha [(value)]="body.fechaHasta" [utc]="false" (valueChangeSelected)="fillFechaHasta($event)" (valueChangeInput)="fillFechaHasta($event)"></app-fecha>
                </div>
                <div class="form-group col-lg-3 col-md-3">
                    <label>{{ "censo.solicitudincorporacion.nIdentificacion" | translate }}</label>
                    <input type="text" class="form-control" pInputText [(ngModel)]="body.numeroIdentificacion">
                </div>
                <div class="form-group col-lg-3 col-md-3">
                    <label>{{ "gratuita.mantenimientoTablasMaestra.literal.apellidos" | translate }}</label>
                    <input type="text" class="form-control" pInputText [(ngModel)]="body.apellidos" [formControl]="formBusqueda.controls['apellidos']">
                </div>
                <div class="form-group col-lg-3 col-md-3">
                    <label>{{ "administracion.parametrosGenerales.literal.nombre" | translate }}</label>
                    <input type="text" class="form-control" pInputText [(ngModel)]="body.nombre" [formControl]="formBusqueda.controls['nombre']">

                </div>
            </div>
        </div>

    </div>
    <div class="card-footer">
        <div class="text-right main-button ">
            <button (click)="restablecerCampos()" pButton type="button" icon="fa fa-eraser" iconPos="left" label="Limpiar"></button>
            <button (click)="buscarSolicitudes()" [disabled]="isBuscar()" pButton type="button" icon="fa fa-search" iconPos="left" label="Buscar"></button>
            <button (click)="irNuevaSolicitud()" pButton type="button" icon="fa fa-plus" iconPos="left" label="{{ 'general.boton.new' | translate}}"></button>
        </div>
    </div>
</div>
<div *ngIf="buscar == true" class="card mt-3" id="tablaFoco">
    <div class="card-body p-0">
        <p-table [columns]="cols" [ngClass]="{'customCursor': selectMultiple}" [(selection)]="selectedDatos" [responsive]="true"
            selectionMode="multiple" #table class="tabla-listado" [value]="datos" [sortOrder]="1" [paginator]="activarPaginacion()"
            (onRowUnselect)="actualizaSeleccionados(selectedDatos)" paginatorPosition="both" [rows]="selectedItem" pageLinks="4">
            <ng-template pTemplate="colgroup" let-columns>
                <colgroup>
                    <col *ngFor="let col of columns" [style.width]="col.width">
                </colgroup>
            </ng-template>
            <ng-template pTemplate="header" let-columns>
                <tr>
                    <th *ngFor="let col of columns" [ngSwitch]="col.field" [pSortableColumn]="col.field">
                        {{col.header}}
                        <p-sortIcon [field]="col.field"></p-sortIcon>
                        <input pDroppable="false" (click)="$event.stopPropagation()" *ngSwitchCase="col.field" pInputText type="text" (input)="table.filter($event.target.value,
                                    col.field, 'contains')">
                    </th>
                </tr>
            </ng-template>

            <ng-template pTemplate="body" let-datoH let-columns="columns" let-rowIndex="rowIndex">
                <tr [pSelectableRow]="datoH" [pSelectableRowIndex]="rowIndex">
                    <td class="text-center" *ngFor="let col of columns">
                        <div>
                            <span *ngIf="col.field !== 'fechaEstado' && col.field !== 'fechaSolicitud' && col.field != 'apeNom'">{{datoH[col.field]}}</span>
                            <span *ngIf="(col.field == 'fechaEstado' && col.field.fechaEstado !==null) || (col.field == 'fechaSolicitud' && col.field.fechaSolicitud !==null)">{{datoH[col.field] | date: 'dd/MM/yyyy'}}
                            </span>
                            <div *ngIf="col.field == 'apeNom'">
                                <a [routerLink]="" (click)="irDetalleSolicitud(datoH)" class="enlace">{{datoH[col.field]}}</a>
                            </div>
                        </div>
                    </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage" let-columns>
                <tr>
                    <td [attr.colspan]="columns.length">
                        {{'censo.busquedaClientesAvanzada.literal.sinResultados' | translate }}
                    </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="paginatorleft">
                <div class="mostrar d-flex text-right justify-content-end">
                    <label class="pr-3 registros-totales">{{ 'informesycomunicaciones.plantillasenvio.ficha.mostrandoRegistros' | translate }} {{table.first +
                        1}} al {{table.first + table.rows}} {{ 'informesycomunicaciones.plantillasenvio.ficha.deUnTotalDe'
                        | translate }} {{table.totalRecords}}</label>
                    <label class="pr-3 numSeleccionados" *ngIf="selectedDatos  && selectedDatos.length > 0">{{'agenda.fichaCalendario.tablaNotificaciones.mostrandoRegistros' | translate}}: {{selectedDatos.length}}
                    </label>
                    <label class="pr-3 numSeleccionados" *ngIf="selectedDatos && selectedDatos.length <= 0">{{'agenda.fichaCalendario.tablaNotificaciones.mostrandoRegistros' | translate}}: 0
                    </label>
                    <label>{{"general.message.mostrar" | translate}}</label>
                    <p-dropdown [(ngModel)]="selectedItem" [options]="rowsPerPage" (onChange)="onChangeRowsPerPages($event)">
                    </p-dropdown>
                    <label class="pl-1"> {{"cargaMasivaDatosCurriculares.numRegistros.literal" | translate}}</label>
                    <div class="ml-3 selectAll">
                        <p-checkbox (onChange)="onChangeSelectAll()" [(ngModel)]="selectAll" binary="true" label="{{ 'tablas.literal.seleccionarTodo' | translate }}"
                            name="groupname"></p-checkbox>
                    </div>
                    <!-- <label class="ml-3 seleccionMultiple" [ngClass]="{' seleccion-multiple': selectMultiple}" (click)="isSelectMultiple()">
                        <i class="pr-2 fa fa-mouse-pointer"></i>{{"general.message.seleccion.multiple" | translate}}</label> -->
                </div>
            </ng-template>
        </p-table>
    </div>
</div>


<div *ngIf="progressSpinner" class="overlay-spinner">
    <div class="loader"></div>
</div>