<p-growl [(value)]="msgs" (onHover)="clear()" life="30000"></p-growl>

<div class="busqueda-container">
  <div class="header-title">
    <i class="fa fa-square"></i>
    <p>{{"menu.censo" | translate}}
      <i class="fa fa-angle-right"></i> {{'menu.censo.buscarSociedades' | translate}}
      <i class="fa fa-angle-right"></i>{{"gratuita.operarEJG.literal.datosIntegrantes" | translate}}</p>
  </div>
  <div class="card">
    <div class="card-header header-ficha">
      <div *ngIf="!esFichaActiva('identificacion')" class="form-row">
        <div class="col-lg-1 col-md-2">
          <div class="img-colegiado">
            <i class="fa fa-users icon-ficha"> </i>
          </div>
        </div>
        <div class="col-lg-11 col-md-10">
          <div class="d-flex justify-content-start mb-1">
            <label (click)="abrirFicha('identificacion')" class="mr-auto title-ficha">{{"censo.busquedaClientes.literal.datosIdentificacion" | translate}}</label>
          </div>
          <div class="d-flex justify-content-between">
            <label>{{"administracion.usuarios.literal.NIF" | translate}}
              <span>{{ body.nifCif }}</span>
            </label>
            <label>{{"administracion.parametrosGenerales.literal.nombre" | translate}}
              <span>{{ body.nombre }}</span>
            </label>
            <label>{{"censo.busquedaClientes.literal.apellido1" | translate}}
              <span>{{ body.apellidos1 }}</span>
            </label>
            <label>{{"censo.busquedaClientes.literal.apellido2" | translate}}
              <span>{{ body.apellidos2 }} </span>
            </label>
            <i [ngClass]="{ 'fa fa-angle-up': openFicha, 'fa fa-angle-down': !openFicha} "></i>
          </div>
        </div>
      </div>
      <div *ngIf="esFichaActiva('identificacion')" class=" header-ficha-open d-flex justify-content-start align-items-center">
        <div class="img-colegiado">
          <i class="fa fa-users icon-ficha"> </i>
        </div>
        <label (click)="abrirFicha('identificacion')" class="title-ficha">{{"censo.busquedaClientes.literal.datosIdentificacion" | translate}}</label>
        <i (click)="abrirFicha('identificacion')" class="fa fa-angle-up ml-auto"></i>
      </div>
    </div>

    <!--cuerpo datos identificacion-->

    <div *ngIf="esFichaActiva('identificacion')" class="card-body card-body-ficha">
      <div class="row">
        <div class="form-group col-lg-3 col-md-6">
          <label>{{"administracion.usuarios.literal.NIF" | translate}} (*)</label>
          <input type="text" class="form-control" [(ngModel)]="body.nifCif" [(disabled)]="isDisablednifCif || disabledAction" pInputText>
        </div>
        <div class="form-group col-lg-3 col-md-6">
          <label>{{"administracion.parametrosGenerales.literal.nombre" | translate}} (*)</label>
          <input type="text" class="form-control" [(ngModel)]="body.nombre" [(disabled)]="isDisabledNombre || disabledAction" pInputText>
        </div>
        <div class="form-group col-lg-3 col-md-6">
          <label>{{"censo.busquedaClientes.literal.apellido1" | translate}} (*)</label>
          <input type="text" class="form-control" [(ngModel)]="body.apellidos1" [(disabled)]="isDisabledApellidos1 || disabledAction"
            pInputText>
        </div>
        <div class="form-group col-lg-3 col-md-6">
          <label>{{"censo.busquedaClientes.literal.apellido2" | translate}}</label>
          <input [(ngModel)]="body.apellidos2" type="text" class="form-control" [(disabled)]="isDisabledApellidos2 || disabledAction"
            pInputText>
        </div>
      </div>
      <br>

      <!--END DATOS GENERALES-->
    </div>
  </div>

  <!-- COMIENZA COLEGIACION -->

  <div class="card">
    <div class="card-header header-ficha">
      <div *ngIf="!esFichaActiva('colegiacion')" class="form-row">
        <div class="col-lg-1 col-md-2">
          <div class="img-colegiado">
            <i class="fa fa-users icon-ficha"> </i>
          </div>
        </div>
        <div class="col-lg-11 col-md-10">
          <div class="d-flex justify-content-start mb-1">
            <label (click)="abrirFicha('colegiacion')" class="mr-auto title-ficha">{{"censo.busquedaClientes.literal.datosColegiacion" | translate}}</label>
          </div>
          <div class="d-flex justify-content-between">
            <label>{{"censo.busquedaClientesAvanzada.literal.tipoColegio" | translate}}
              <span>{{ descripcionTipoColegio.label }}</span>
            </label>
            <label>{{"censo.datosDireccion.literal.provincia" | translate}}
              <span>{{ descripcionProvincia.label }}</span>
            </label>
            <label>{{"censo.resultadoDuplicados.numeroColegiado" | translate}}
              <span>{{ body.numColegiado }}</span>
            </label>
            <i (click)="abrirFicha('colegiacion')" [ngClass]="{ 'fa fa-angle-up': openFicha, 'fa fa-angle-down': !openFicha} "></i>
          </div>
        </div>
      </div>
      <div *ngIf="esFichaActiva('colegiacion')" class=" header-ficha-open d-flex justify-content-start align-items-center">
        <div class="img-colegiado">
          <i class="fa fa-users icon-ficha"> </i>
        </div>
        <label (click)="abrirFicha('colegiacion')" class="title-ficha">{{"censo.busquedaClientes.literal.datosColegiacion" | translate}}</label>
        <i (click)="abrirFicha('colegiacion')" class="fa fa-angle-up ml-auto"></i>
      </div>
    </div>

    <!--COMIENZO COLEGIACION-->

    <div *ngIf="esFichaActiva('colegiacion')" class="card-body card-body-ficha">


      <div class="row">
        <div class="form-group col-lg-3 col-md-6">
          <label>{{"censo.busquedaClientesAvanzada.literal.tipoColegio" | translate}} (*)</label>
          <p-dropdown [(ngModel)]="body.idTipoColegio" (ngModelChange)="actualizarDescripcionTipoColegio()" class="select-form" [options]="colegiosArray"
          [(disabled)]="isDisabledTipoColegio || disabledAction" placeholder="{{'general.boton.seleccionar' | translate}}"
          [filter]="true" filterBy="label,labelSinTilde" [showClear]="true"></p-dropdown>
        </div>
        <div *ngIf="esColegiado" class="form-group col-lg-3 col-md-6">
          <label>{{"censo.busquedaClientesAvanzada.literal.colegio" | translate}}</label>
          <p-dropdown [options]="colegios" [(ngModel)]="body.colegio" [(disabled)]="isDisabledColegio || disabledAction" class="select-form"
            (onChange)="onChangeColegio($event.value)" placeholder="{{'general.boton.seleccionar' | translate}}"
            [filter]="true" filterBy="label,labelSinTilde" [showClear]="true"></p-dropdown>
        </div>
        <div *ngIf="!esColegiado" class="form-group col-lg-3 col-md-6">
          <label>{{"censo.datosDireccion.literal.provincia" | translate}}</label>
          <p-dropdown [(ngModel)]="body.idProvincia" [(disabled)]="isDisabledProvincia || disabledAction" (ngModelChange)="actualizarDescripcionProvincia()"
            class="select-form" [options]="provinciasArray" placeholder="{{'general.boton.seleccionar' | translate}}"
            [filter]="true" filterBy="label,labelSinTilde" [showClear]="true"></p-dropdown>
        </div>
        <div class="form-group col-lg-3 col-md-6">
          <label>{{"censo.resultadoDuplicados.numeroColegiado" | translate}}</label>
          <input type="text" class="form-control" [(ngModel)]="body.numColegiado" [(disabled)]="isDisabledNumColegio || disabledAction"
            pInputText>
        </div>
      </div>
      <br>

      <!--END DATOS GENERALES-->
    </div>
  </div>

  <!-- COMIENZA VINCULACION -->
  <div class="card">
    <div class="card-header header-ficha">
      <div *ngIf="!esFichaActiva('vinculacion')" class="form-row">
        <div class="col-lg-1 col-md-2">
          <div class="img-colegiado">
            <i class="fa fa-users icon-ficha"> </i>
          </div>
        </div>
        <div class="col-lg-11 col-md-10">
          <div class="d-flex justify-content-start mb-1">
            <label (click)="abrirFicha('vinculacion')" class="mr-auto title-ficha">{{"censo.busquedaClientes.literal.cargo" | translate}}</label>
          </div>
          <div class="d-flex justify-content-between">
            <label>{{"censo.consultaComponentesJuridicos.literal.fechaCargo" | translate}}
              <span>{{ body.fechaCargo }}</span>
            </label>
            <label>{{"censo.consultaComponentesJuridicos.literal.fechaFinCargo" | translate}}
              <span>{{ body.fechaBajaCargo }}</span>
            </label>
            <label>{{"censo.consultaComponentesJuridicos.literal.cargo" | translate}}
              <span>{{ descripcionCargo.label }}</span>
            </label>
            <label> {{"censo.consultaComponentesJuridicos.literal.descripcioncargo" | translate}}
              <span>{{ body.cargo }}</span>
            </label>
            <label>{{"censo.consultaComponentesJuridicos.literal.Participacion" | translate}}
              <span>{{ body.capitalSocial }}</span>
            </label>
            <i (click)="abrirFicha('vinculacion')" [ngClass]="{ 'fa fa-angle-up': openFicha, 'fa fa-angle-down': !openFicha} "></i>
          </div>
        </div>
      </div>
      <div *ngIf="esFichaActiva('vinculacion')" class=" header-ficha-open d-flex justify-content-start align-items-center">
        <div class="img-colegiado">
          <i class="fa fa-users icon-ficha"> </i>
        </div>
        <label (click)="abrirFicha('vinculacion')" class="title-ficha">{{"censo.busquedaClientes.literal.cargo" | translate}}</label>
        <i (click)="abrirFicha('vinculacion')" class="fa fa-angle-up ml-auto"></i>
      </div>
    </div>

    <!--cuerpo datos vinculacion-->

    <div *ngIf="esFichaActiva('vinculacion')" class="card-body card-body-ficha">
      <div class="d-flex align-items-end row">
        <div class="col-lg-3 col-md-6">
          <div class="form-row">
            <div class="form-group col-lg-6 col-md-6">
              <label>{{"censo.consultaComponentesJuridicos.literal.fechaCargo" | translate}}</label>
              <app-fecha [(value)]="fechaCarga" [disabled]="historico || disabledAction" [utc]="false" (valueChangeSelected)="fillFechaCarga($event)"
                (valueChangeInput)="detectFechaCargaInput($event)"></app-fecha>
            </div>
            <div class="form-group col-lg-6 col-md-6">
              <label>{{"censo.consultaDatos.literal.fechaFin" | translate}}</label>
              <app-fecha [(value)]="fechaBajaCargo" [disabled]="historico || disabledAction" [utc]="false" (valueChangeSelected)="fillFechaBajaCargo($event)"
                (valueChangeInput)="detectFechaBajaCargoInput($event)"></app-fecha>
            </div>
          </div>
        </div>
        <div class="form-check col-lg-1 col-md-2 mb-4">
          <p-checkbox [(ngModel)]='body.socio' binary="true" [(disabled)]="historico || disabledAction" label="Socio"></p-checkbox>
        </div>
        <div class="form-group col-lg-2 col-md-4">
          <label>{{"censo.consultaComponentesJuridicos.literal.cargo" | translate}}</label>
          <p-dropdown [(ngModel)]="body.idCargo" (ngModelChange)="actualizarDescripcionCargo()" [(disabled)]="historico || disabledAction"
            class="select-form" [options]="cargosArray" placeholder="{{'general.boton.seleccionar' | translate}}"
            [filter]="true" filterBy="label,labelSinTilde" [showClear]="true"></p-dropdown>
        </div>
        <div class="form-group col-lg-4 col-md-8">
          <label>{{"censo.consultaComponentesJuridicos.literal.descripcioncargo" | translate}}</label>
          <input type="text" class="form-control" [(disabled)]="historico || disabledAction" [(ngModel)]="body.cargo" pInputText>
        </div>
        <div class="form-group col-lg-2 col-md-4">
          <label>{{"censo.consultaComponentesJuridicos.literal.Participacion" | translate}}</label>
          <input type="text" class="form-control" [(disabled)]="historico || disabledAction" [(ngModel)]="body.capitalSocial" ui-number-mask="3"
            (ngModelChange)="onChange($event)" pInputText>
        </div>


      </div>
      <br>

      <!--END DATOS GENERALES-->
    </div>
  </div>
  <div class="mt-3 text-right main-button ">
    <button (click)="backTo()" pButton type="button" icon="fa fa-angle-left" iconPos="left" label="{{ 'general.boton.volver' | translate}}"></button>
    <button *ngIf="editar" (click)="guardar();" pButton type="button" icon="	fa fa-edit " [(disabled)]="historico || disabledAction"
      iconPos="left" label="{{ 'general.boton.guardarCerrar' | translate}}"></button>
  </div>
</div>

<div *ngIf="progressSpinner" class="overlay-spinner">
  <!--<p-progressSpinner animationDuration="1s"></p-progressSpinner>-->
  <div class="loader"></div>
</div>