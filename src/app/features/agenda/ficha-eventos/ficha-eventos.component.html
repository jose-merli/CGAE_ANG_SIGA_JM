<p-growl [(value)]="msgs" (onHover)="clear()" life="30000"></p-growl>
<div class="busqueda-container">
  <div class="header-title">
    <i class="fa fa-square"></i>
    <p>{{ 'agenda.fichaEventos.cabecera' | translate }}</p>
  </div>

  <!-- FICHA DATOS GENERALES -->
  <div class="card">
    <!-- Cabecera -->
    <div class="card-header header-ficha" (click)="abreCierraFicha('generales')">
      <div *ngIf="!esFichaActiva('generales')" class="form-row">
        <div class="col-lg-1 col-md-2">
          <div class="img-colegiado">
            <i class="fa fa-file-pdf icon-ficha"></i>
          </div>
        </div>
        <div class="col-lg-11 col-md-10">
          <div class="d-flex justify-content-start mb-1">
            <label class="mr-auto title-ficha">{{ "general.message.datos.generales" | translate}}</label>
          </div>
          <div class="d-flex justify-content-between">
            <label>{{ 'agenda.fichaEventos.datosGenerales.calendario' | translate }}:
              <span>{{ newEvent.tipoCalendario }}</span>
            </label>
            <label>{{ 'agenda.fichaEventos.datosGenerales.tipoEvento' | translate }}:
              <span>{{ newEvent.tipoEvento }}</span>
            </label>
            <label>{{ 'agenda.fichaEventos.datosGenerales.titulo' | translate }}:
              <span>{{ newEvent.title }}</span>
            </label>
            <label>{{ 'form.busquedaCursos.literal.estado' | translate }}:
              <span>{{ newEvent.estadoEvento }}</span>
            </label>
            <label>{{ 'agenda.fichaEventos.datosGenerales.fechaInicio' | translate }}:
              <span>{{ newEvent.fechaInicioString }}</span>
            </label>
            <label>{{ 'agenda.fichaEventos.datosGenerales.lugar' | translate }}:
              <span>{{ newEvent.lugar }}</span>
            </label>
            <i class="fa fa-angle-down float-right"></i>
          </div>
        </div>
      </div>
      <div *ngIf="esFichaActiva('generales')" class=" header-ficha-open d-flex justify-content-start align-items-center">
        <div class="img-colegiado">
          <i class="fa fa-file-pdf icon-ficha"></i>
        </div>
        <label class="title-ficha">{{ "general.message.datos.generales" | translate}}</label>
        <i class="fa fa-angle-up ml-auto"></i>
      </div>
    </div>

    <!-- Cuerpo-->
    <div class="card-body card-body-ficha" *ngIf="esFichaActiva('generales')">
      <div class="form-row mb-3">
        <div class="bloque col-lg-7 col-md-7">
          <div class="row mb-3">
            <label class="ml-2">
              <strong>{{ 'agenda.fichaEventos.datosGenerales.datosEvento.cabecera' | translate }}</strong>
            </label>
          </div>
          <div class="row mb-3">
            <div class="col-lg-6 col-md-6">
              <label>{{'agenda.fichaEventos.datosGenerales.calendario' | translate }} (*)</label>
              <p-dropdown [ngClass]="styleObligatorio('', newEvent.idTipoCalendario)" class="select-form" [options]="comboCalendars" [filter]="true" filterBy="label,labelSinTilde" placeholder="{{'tablas.literal.seleccionar' | translate}}"
                name="type" (ngModelChange)="onlyCheckDatos()" [(ngModel)]="newEvent.idTipoCalendario" [disabled]="modoTipoEventoInscripcion || isFormacionCalendar || modoEdicionEvento  || tipoAccesoLectura"
                [showClear]="true"></p-dropdown>
            </div>
            <div class="col-lg-6 col-md-6">
              <label>{{'agenda.fichaEventos.datosGenerales.tipoEvento' | translate}}</label>
              <p-dropdown class="select-form" [options]="comboTipoEvento" name="tipoEvento" [(ngModel)]="newEvent.idTipoEvento" placeholder="-"
                [disabled]="disabledTipoEvento || isFormacionCalendar || tipoAccesoLectura" [showClear]="true"></p-dropdown>
            </div>
          </div>
          <div class="row mb-3">
            <div class="col-lg-6 col-md-6">
              <!-- <input *ngIf="!isInstitucionGeneral" type="text" class="form-control" pInputText name="titulo" [(ngModel)]="newEvent.title"
                [disabled]="tipoAccesoLectura || isEventoCumplidoOrCancelado || (!isFiestaLocal && !isInstitucionGeneral) || selectedTipoLaboral || isFiestaAutonomica"> -->
              <label>{{'agenda.fichaEventos.datosGenerales.titulo' | translate}} (*)</label>
              <input [ngClass]="styleObligatorio('', newEvent.title)" type="text" class="form-control" pInputText name="titulo" (ngModelChange)="onlyCheckDatos()" [(ngModel)]="newEvent.title" [disabled]="tipoAccesoLectura || isEventoCumplidoOrCancelado">
            </div>
            <div *ngIf="!selectedTipoLaboral" class="col-lg-6 col-md-6">
              <label>{{ 'form.busquedaCursos.literal.estado' | translate}}</label>
              <p-dropdown class="select-form" [options]="comboEstados" name="estado" [(ngModel)]="newEvent.idEstadoEvento" placeholder="{{'tablas.literal.seleccionar' | translate}}"
                [disabled]="tipoAccesoLectura || isEventoCumplidoOrCancelado" [showClear]="true"></p-dropdown>
            </div>
          </div>
          <div class="row mb-3">
            <div *ngIf="modoEdicionEventoByAgenda" class="col-lg-6 col-md-6">
              <label class="pb-2">{{'agenda.fichaEventos.datosGenerales.fechaInicio' | translate}} (*)</label>
              <app-fecha [inputStyleClass]="styleObligatorio('', newEvent.start)" #fechaIni [(value)]="newEvent.start" (valueChangeInput)="fillStart($event)" [showTime]="true" [disabledToday]="disabledToday"
                [disabled]="tipoAccesoLectura || isEventoCumplidoOrCancelado" (valueChangeSelected)="fillStart($event)" [utc]="false">
              </app-fecha>
            </div>
            <div *ngIf="!modoEdicionEventoByAgenda" class="col-lg-6 col-md-6">
              <label class="pb-2">{{'agenda.fichaEventos.datosGenerales.fechaInicio' | translate}} (*)</label>
              <app-fecha [inputStyleClass]="styleObligatorio('', newEvent.start)" #fechaIni [(value)]="newEvent.start" (valueChangeInput)="fillStartEventInput($event)" [showTime]="true" [minDate]="invalidDateMinEditionMode"
                [maxDate]="invalidDateMaxEditionMode" [disabled]="tipoAccesoLectura || isEventoCumplidoOrCancelado" (valueChangeSelected)="fillStartEvent($event)"
                [disabledToday]="disabledToday" [utc]="false"></app-fecha>
            </div>
            <div class="col-lg-6 col-md-6">
              <label class="pb-2">{{'agenda.fichaEventos.datosGenerales.fechaFin' | translate}} (*)</label>
              <app-fecha [inputStyleClass]="styleObligatorio('', newEvent.end)" #fechaFi [(value)]="newEvent.end" (valueChangeInput)="fillEndInput($event)" [showTime]="true" [minDate]="invalidDateMin"
                [maxDate]="invalidDateMax" [disabled]="tipoAccesoLectura || isEventoCumplidoOrCancelado" (valueChangeSelected)="fillEnd($event)"
                [disabledToday]="true" [disabledDelete]="true" [utc]="false"></app-fecha>
            </div>
          </div>
          <div class="row mb-3">
            <div *ngIf="!selectedTipoLaboral" class="col-lg-12 col-md-12">
              <label>{{'agenda.fichaEventos.datosGenerales.lugar' | translate}}</label>
              <input type="text" class="form-control" pInputText name="lugar" [(ngModel)]="newEvent.lugar" [disabled]="tipoAccesoLectura || isEventoCumplidoOrCancelado">
            </div>
            <div *ngIf="selectedTipoLaboral" class="col-lg-12 col-md-12">
              <label>{{'agenda.fichaEvento.tarjetaGenerales.partidoJudicial' | translate}}</label>
              <p-dropdown class="select-form" [options]="comboPartidoJudicial" name="estado" [(ngModel)]="newEvent.lugar" placeholder="{{'tablas.literal.seleccionar' | translate }}"
                [disabled]="tipoAccesoLectura || isEventoCumplidoOrCancelado" [showClear]="true"></p-dropdown>
            </div>
          </div>
          <div class="row mb-3">
            <div class="col-lg-12 col-md-12">
              <label>{{'administracion.parametrosGenerales.literal.descripcion' | translate}}</label>
              <input type="text" class="form-control" pInputText name="descripcion" [(ngModel)]="newEvent.descripcion" [disabled]="tipoAccesoLectura || isEventoCumplidoOrCancelado">
            </div>
          </div>
          <div class="row mb-3">
            <div class="col-lg-12 col-md-12">
              <label>{{'agenda.fichaEventos.datosGenerales.recursos' | translate}}</label>
              <input type="text" class="form-control" pInputText name="recursos" [(ngModel)]="newEvent.recursos" [disabled]="tipoAccesoLectura || isEventoCumplidoOrCancelado">
            </div>
          </div>
        </div>
        <div class="bloque col-lg-5 col-md-5">
          <div class="row mb-3">
            <label>
              <strong> {{ 'agenda.fichaEventos.datosGenerales.datosRepeticion.cabecera' | translate }}</strong>
            </label>
          </div>
          <div class="row mb-4">
            <div class="col-lg-6 col-md-6">
              <label class="pb-2">{{'agenda.fichaEventos.datosGenerales.fechaInicio' | translate}} (*)</label>
              <app-fecha [inputStyleClass]="styleObligatorioOpcional('opcional', newEvent.fechaInicioRepeticion)" [(value)]="newEvent.fechaInicioRepeticion" (valueChangeInput)="isCheckFechaInicioRepeticion($event)" [minDate]="newEvent.start"
                [maxDate]="newEvent.fechaFinRepeticion" [disabled]="tipoAccesoLectura || selectedTipoLaboral || tipoInscripcionEvento || modoTipoEventoInscripcion || isEventoCumplidoOrCancelado"
                (valueChangeSelected)="isCheckFechaInicioRepeticion($event)" [utc]="false"></app-fecha>
            </div>
            <div class="col-lg-6 col-md-6">
              <label class="pb-2">{{'agenda.fichaEventos.datosGenerales.fechaFin' | translate}} (*)</label>
              <app-fecha [inputStyleClass]="styleObligatorioOpcional('opcional', newEvent.fechaFinRepeticion)"  [(value)]="newEvent.fechaFinRepeticion" (valueChangeInput)="isCheckFechaFinRepeticion($event)" [minDate]="newEvent.fechaInicioRepeticion"
                [disabled]="tipoInscripcionEvento || tipoAccesoLectura || selectedTipoLaboral || modoTipoEventoInscripcion || isEventoCumplidoOrCancelado"
                (valueChangeSelected)="isCheckFechaFinRepeticion($event)" [utc]="false"></app-fecha>
            </div>
          </div>
          <div class="row mb-3">
            <div class="col-lg-12 col-md-12">
              <div class="row">
                <div class="col-lg-4 col-md-4">
                  <label>{{'agenda.fichaEventos.datosGenerales.repetirCada' | translate}}: (*)</label>
                </div>
                <div class="col-lg-8 col-md-8">
                  <p-dropdown [ngClass]="styleObligatorioOpcional('opcional', newEvent.tipoRepeticion)" (onChange)="isCheckTipoRepeticion()" [options]="comboRepeatEvery" [(ngModel)]="newEvent.tipoRepeticion" placeholder="{{'tablas.literal.seleccionar' | translate }}"
                    [disabled]="tipoInscripcionEvento || tipoAccesoLectura || selectedTipoLaboral || modoTipoEventoInscripcion || isEventoCumplidoOrCancelado"
                    [showClear]="true"></p-dropdown>
                </div>
              </div>
            </div>
          </div>
          <div class="row mb-3">
            <div *ngIf="newEvent.tipoRepeticion == 'S'" class="col-lg-12 col-md-12">
              <p-selectButton [options]="comboRepeatOn" multiple="multiple" [(ngModel)]="newEvent.valoresRepeticion" [disabled]="tipoInscripcionEvento || tipoAccesoLectura || selectedTipoLaboral || modoTipoEventoInscripcion || isEventoCumplidoOrCancelado"></p-selectButton>
            </div>
            <div *ngIf="newEvent.tipoRepeticion == 'D'" class="col-lg-12 col-md-12">
              <p-selectButton class="daysSelectButton" [options]="comboDays" multiple="multiple" [(ngModel)]="newEvent.valoresRepeticion"
                [disabled]="tipoInscripcionEvento || tipoAccesoLectura || selectedTipoLaboral || modoTipoEventoInscripcion || isEventoCumplidoOrCancelado"></p-selectButton>
              <p class="mt-2">{{'agenda.fichaEventos.datosRepeticion.diasSeleccionados' | translate}}:
                <span *ngFor="let d of newEvent.valoresRepeticion">{{d}}, </span>
              </p>
            </div>
          </div>
          <div class="row mb-3">
            <div class="col-lg-12 col-md-12">
              <div class="ui-g-12">
                <p-radioButton (click)="isCheckTipoDiasRepeticion()" name="laborales" value="L" label="{{ 'fichaEventos.datosRepeticion.tipoDiasRepeticion.diasLaborales' | translate}}"
                  [(ngModel)]="newEvent.tipoDiasRepeticion" [disabled]="tipoInscripcionEvento || disabledRadioButton() || isEventoCumplidoOrCancelado"></p-radioButton>
              </div>
              <div class="ui-g-12">
                <p-radioButton (click)="isCheckTipoDiasRepeticion()" name="festivos" value="F" label="{{ 'fichaEventos.datosRepeticion.tipoDiasRepeticion.diasFestivos' | translate}}"
                  [(ngModel)]="newEvent.tipoDiasRepeticion" [disabled]="tipoInscripcionEvento || disabledRadioButton() || isEventoCumplidoOrCancelado"></p-radioButton>
              </div>
              <div class="ui-g-12">
                <p-radioButton (click)="isCheckTipoDiasRepeticion()" name="ambos" value="A" label="{{ 'fichaEventos.datosRepeticion.tipoDiasRepeticion.ambos' | translate}}"
                  [(ngModel)]="newEvent.tipoDiasRepeticion" [disabled]="tipoInscripcionEvento || disabledRadioButton() || isEventoCumplidoOrCancelado"></p-radioButton>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="card-footer" *ngIf="esFichaActiva('generales')">
      <div class="text-right main-button">
        <button pButton (click)="restEvent()" type="button" icon="fa fa-undo" iconPos="left" label="{{ 'general.boton.restablecer'| translate }}"
          [disabled]="tipoAccesoLectura || isEventoCumplidoOrCancelado"></button>
        <button pButton (click)="checkDatos()" type="button" icon="far fa-save" iconPos="left" label="{{ 'general.boton.guardar' | translate }}"
          [disabled]="tipoAccesoLectura || isEventoCumplidoOrCancelado"></button>
        <button pButton (click)="deleteEvent()" type="button" icon="fa fa-trash-alt" iconPos="left" label="{{'general.boton.eliminar'  | translate}}"
          [disabled]="tipoAccesoLectura || isEventoCumplidoOrCancelado || !modoEdicionEvento"></button>
      </div>
    </div>
  </div>

  <!-- NOTIFICACIONES-->
  <div class="card">
    <!-- Cabecera -->
    <div class="card-header header-ficha" (click)="abreCierraFicha('notify')">
      <div *ngIf="!esFichaActiva('notify')" class="form-row">
        <div class="col-lg-1 col-md-2">
          <div class="img-colegiado">
            <i class="fa fa-bell icon-ficha"></i>
          </div>
        </div>
        <div class="col-lg-11 col-md-10">
          <div class="d-flex justify-content-start mb-1">
            <label class="mr-auto title-ficha">{{'formacion.fichaCalendario.notificaciones.cabecera' | translate}}</label>
          </div>
          <div *ngIf="datosNotificaciones.length < 5 && datosNotificaciones.length != 0" class="d-flex justify-content-between">
            <label *ngFor="let noti of datosNotificaciones">
              {{ 'envios.plantillas.literal.tipoenvio' | translate }}:
              <span>{{ noti.tipoEnvio }} </span> - {{ 'formacion.datosNotificaciones.cuando.cabecera' | translate }}:
              <span>{{ noti.descripcionCuando }}</span>
            </label>
            <i class="fa fa-angle-down float-right"></i>
          </div>
          <div *ngIf="datosNotificaciones.length >= 5" class="d-flex justify-content-between">
            <label>{{ 'agenda.fichaEvento.tarjetaNotificaciones.resumen.numNotificaciones' | translate }}:
              <span>{{ datosNotificaciones.length }}</span>
            </label>
            <i class="fa fa-angle-down float-right"></i>
          </div>
          <div *ngIf="datosNotificaciones.length == 0" class="d-flex justify-content-between">
            <label>{{ 'agenda.fichaEvento.tarjetaNotificaciones.resumen.numNotificaciones' | translate }}:
              <span>0</span>
            </label>
            <i class="fa fa-angle-down float-right"></i>
          </div>
        </div>
      </div>
      <div *ngIf="esFichaActiva('notify')" class=" header-ficha-open d-flex justify-content-start align-items-center">
        <div class="img-colegiado">
          <i class="fa fa-bell icon-ficha"></i>
        </div>
        <label class="title-ficha">{{'formacion.fichaCalendario.notificaciones.cabecera' | translate}}</label>
        <i class="fa fa-angle-up ml-auto"></i>
      </div>
    </div>

    <!-- Cuerpo-->
    <div class="card-body card-body-ficha" *ngIf="esFichaActiva('notify')">
      <div class="row">
        <!-- Modo Mostrar -->
        <div *ngIf="(selectMultipleNotifications || selectAllNotifications) && !pressNewNotificacion">
          <p-dataTable emptyMessage="{{ 'general.message.no.registros' | translate}}" [ngClass]="{'customCursor': selectMultipleNotifications}"
            [(selection)]="selectedDatosNotifications" (onRowSelect)="actualizaSeleccionadosNotifications(selectedDatosNotifications)"
            (onRowUnselect)="actualizaSeleccionadosNotifications(selectedDatosNotifications)" pageLinks="4" dataKey="idNotificacion"
            [responsive]="true" selectionMode="multiple" #tableNotifications class="tabla-listado" [value]="datosNotificaciones"
            [sortOrder]="sortO" [paginator]="true" paginatorPosition="both" [rows]="selectedNotification">

            <p-column [sortable]="true" [field]="colsNotifications[0].field" [header]="
                  'menu.facturacion.plantillas'
                    | translate
                " [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
              <ng-template let-col let-dato="rowData" pTemplate="body">
                <span>{{ dato[colsNotifications[0].value] }} </span>
              </ng-template>
            </p-column>

            <p-column [sortable]="true" [field]="colsNotifications[1].field" [header]="'envios.plantillas.literal.tipoenvio' | translate"
              [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
              <ng-template let-dato="rowData" pTemplate="body">
                <span>{{ dato[colsNotifications[1].field] }} </span>
              </ng-template>
            </p-column>

            <p-column [sortable]="true" [field]="colsNotifications[2].field" [header]="'formacion.datosNotificaciones.cuando.cabecera' | translate"
              [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
              <ng-template let-dato="rowData" pTemplate="body">
                <span>{{ dato[colsNotifications[2].field] }} </span>
              </ng-template>
            </p-column>

            <p-column [sortable]="true" [field]="colsNotifications[3].field" [header]="'formacion.datosNotificaciones.unidadMedida.literal' | translate"
              [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
              <ng-template let-dato="rowData" pTemplate="body">
                <span> {{ dato[colsNotifications[3].value] }} </span>
              </ng-template>
            </p-column>

            <p-column [sortable]="true" [field]="colsNotifications[4].field" [header]="'formacion.datosNotificaciones.antesDespues.literal' | translate"
              [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
              <ng-template let-dato="rowData" pTemplate="body">
                <span> {{ dato[colsNotifications[4].value] }} </span>
              </ng-template>
            </p-column>

            <ng-template pTemplate="paginatorLeft">
              <div class="mostrar d-flex text-right justify-content-end">
                <label class="pr-3 registros-totales">{{'informesycomunicaciones.plantillasenvio.ficha.mostrandoRegistros' | translate}} {{tableNotifications.first
                  + 1}} al {{tableNotifications.first + tableNotifications.rows}} {{ 'informesycomunicaciones.plantillasenvio.ficha.deUnTotalDe'
                  | translate }} {{tableNotifications.totalRecords}}</label>
                <label class="pr-3 numSeleccionados">{{'agenda.fichaCalendario.tablaNotificaciones.mostrandoRegistros' | translate }}: {{numSelectedNotification}}</label>
                <label>{{ "general.message.mostrar" | translate}}</label>
                <p-dropdown [(ngModel)]="selectedNotification" [options]="rowsPerPage" (onChange)="onChangeRowsPerPagesNotifications($event)"></p-dropdown>
                <label class="pl-1"> {{"cargaMasivaDatosCurriculares.numRegistros.literal" | translate}}</label>
                <div class="ml-3 selectAll">
                  <p-checkbox (onChange)="onChangeSelectAllNotifications()" [(ngModel)]="selectAllNotifications" binary="true" label="{{'tablas.literal.seleccionarTodo' | translate}}"
                    name="groupname"></p-checkbox>
                </div>
                <label class="ml-3 seleccionMultiple" [ngClass]="{'seleccion-multiple': selectMultipleNotifications}" (click)="isSelectMultipleNotifications(); selectedDatosNotifications=false">
                  <i class="pr-2 fa fa-mouse-pointer"></i>{{ "general.message.seleccion.multiple" | translate}}</label>
              </div>
            </ng-template>
          </p-dataTable>
        </div>

        <!-- Modo Edición -->
        <div *ngIf="!selectMultipleNotifications && !pressNewNotificacion && !selectAllNotifications">
          <p-dataTable emptyMessage="{{ 'general.message.no.registros' | translate}}" [ngClass]="{ customCursor: selectMultipleNotifications }"
            dataKey="idNotificacion" selectionMode="multiple" [(selection)]="selectedDatosNotifications" [responsive]="true"
            #tableNotifications class="tabla-listado" [paginator]="true" (onRowSelect)="actualizaSeleccionadosNotificationsEdit(selectedDatosNotifications)"
            (onRoUnselect)="actualizaSeleccionadosNotificationsEdit(selectedDatosNotifications)" [value]="datosNotificaciones"
            [sortOrder]="1" [paginator]="true" paginatorPosition="both" [rows]="selectedNotification" [editable]="!selectMultipleNotifications && !isEventoCumplidoOrCancelado">

            <p-column [sortable]="true" [field]="colsNotifications[0].field" [header]="
                  'menu.facturacion.plantillas'
                    | translate
                " [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
              <ng-template let-col let-dato="rowData" pTemplate="body">
                <!-- <span *ngIf="!dato.isMod">{{ dato[colsNotifications[0].value] }} </span> -->
                <div *ngIf="(!dato.isMod || isEventoCumplidoOrCancelado) && setItalic(dato)">
                  <span [ngStyle]="{'font-style': 'italic', 'font-weight':'bold', 'text-decoration':'line-through'}">{{dato[colsNotifications[0].value]}}</span>
                </div>
                <div *ngIf="(!dato.isMod || isEventoCumplidoOrCancelado) && !setItalic(dato) ">
                  <span>{{ dato[colsNotifications[0].value] }}</span>
                </div>
                <p-dropdown *ngIf="dato.isMod && !isEventoCumplidoOrCancelado" class="select-form" [(ngModel)]="dato[colsNotifications[0].field]"
                  [options]="comboTemplates" placeholder="{{'tablas.literal.seleccionar' | translate}}" name="type" (onChange)="onChangeTemplates($event, dato)"
                  [filter]="true" filterBy="label,labelSinTilde" [showClear]="true"></p-dropdown>
              </ng-template>
            </p-column>

            <p-column [sortable]="true" [field]="colsNotifications[1].field" [header]="'envios.plantillas.literal.tipoenvio' | translate"
              [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
              <ng-template let-dato="rowData" pTemplate="body">
                <div *ngIf="(!dato.isMod || isEventoCumplidoOrCancelado) && setItalic(dato)">
                  <span [ngStyle]="{'font-style': 'italic', 'font-weight':'bold', 'text-decoration':'line-through'}">{{dato[colsNotifications[1].field]}}</span>
                </div>
                <div *ngIf="(!dato.isMod || isEventoCumplidoOrCancelado) && !setItalic(dato)">
                  <span>{{ dato[colsNotifications[1].field] }}</span>
                </div>
                <span *ngIf="dato.isMod && !isEventoCumplidoOrCancelado">{{ dato[colsNotifications[1].field] }} </span>
              </ng-template>
            </p-column>

            <p-column [sortable]="true" [field]="colsNotifications[2].field" [header]="'formacion.datosNotificaciones.cuando.cabecera' | translate"
              [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
              <ng-template let-dato="rowData" pTemplate="body">
                <!-- <span *ngIf="!dato.isMod">{{ dato[colsNotifications[2].field] }} </span> -->
                <div *ngIf="(!dato.isMod || isEventoCumplidoOrCancelado) && setItalic(dato)">
                  <span [ngStyle]="{'font-style': 'italic', 'font-weight':'bold', 'text-decoration':'line-through'}">{{dato[colsNotifications[2].field]}}</span>
                </div>
                <div *ngIf="(!dato.isMod || isEventoCumplidoOrCancelado) && !setItalic(dato)">
                  <span>{{ dato[colsNotifications[2].field] }}</span>
                </div>
                <input *ngIf="dato.isMod && !isEventoCumplidoOrCancelado" (ngModelChange)="editNotificaciones(dato)" type="text" class="form-control"
                  [(ngModel)]="dato[colsNotifications[2].field]" type="number" min="0" pInputText>
              </ng-template>
            </p-column>

            <p-column [sortable]="true" [field]="colsNotifications[3].field" [header]="'formacion.datosNotificaciones.unidadMedida.literal' | translate"
              [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
              <ng-template let-dato="rowData" pTemplate="body">
                <!-- <span *ngIf="!dato.isMod">{{ dato[colsNotifications[3].value] }} </span> -->
                <div *ngIf="(!dato.isMod || isEventoCumplidoOrCancelado) && setItalic(dato)">
                  <span [ngStyle]="{'font-style': 'italic', 'font-weight':'bold', 'text-decoration':'line-through'}">{{dato[colsNotifications[3].value]}}</span>
                </div>
                <div *ngIf="(!dato.isMod || isEventoCumplidoOrCancelado) && !setItalic(dato)">
                  <span>{{ dato[colsNotifications[3].value] }}</span>
                </div>
                <p-dropdown *ngIf="dato.isMod && !isEventoCumplidoOrCancelado" (ngModelChange)="editNotificaciones(dato)" class="select-form"
                  [(ngModel)]="dato[colsNotifications[3].field]" [options]="comboMeasureUnit" [filter]="false" placeholder="{{'tablas.literal.seleccionar' | translate}}"
                  name="type" [showClear]="true"></p-dropdown>
              </ng-template>
            </p-column>

            <p-column [sortable]="true" [field]="colsNotifications[4].field" [header]="'formacion.datosNotificaciones.antesDespues.literal' | translate"
              [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
              <ng-template let-dato="rowData" pTemplate="body">
                <!-- <span *ngIf="!dato.isMod">{{ dato[colsNotifications[4].value] }} </span> -->
                <div *ngIf="(!dato.isMod || isEventoCumplidoOrCancelado) && setItalic(dato)">
                  <span [ngStyle]="{'font-style': 'italic', 'font-weight':'bold', 'text-decoration':'line-through'}">{{dato[colsNotifications[4].value]}}</span>
                </div>
                <div *ngIf="(!dato.isMod || isEventoCumplidoOrCancelado) && !setItalic(dato)">
                  <span>{{ dato[colsNotifications[4].value] }}</span>
                </div>
                <p-dropdown *ngIf="dato.isMod && !isEventoCumplidoOrCancelado" (ngModelChange)="editNotificaciones(dato)" class="select-form"
                  [(ngModel)]="dato[colsNotifications[4].field]" [options]="comboAfterBefore" [filter]="false" placeholder="{{'tablas.literal.seleccionar' | translate}}"
                  name="type" [showClear]="true"></p-dropdown>
              </ng-template>
            </p-column>

            <ng-template pTemplate="paginatorLeft">
              <div class="mostrar d-flex text-right justify-content-end">
                <label class="pr-3 registros-totales">{{'informesycomunicaciones.plantillasenvio.ficha.mostrandoRegistros' | translate}} {{ tableNotifications.first
                  + 1 }} al {{ tableNotifications.first + tableNotifications.rows }} {{ 'informesycomunicaciones.plantillasenvio.ficha.deUnTotalDe'
                  | translate }} {{ tableNotifications.totalRecords }}</label>
                <label class="pr-3 numSeleccionados">{{'agenda.fichaCalendario.tablaNotificaciones.mostrandoRegistros' | translate }}: {{ numSelectedNotification
                  }}</label>
                <label>{{ "general.message.mostrar" | translate }}</label>
                <p-dropdown [(ngModel)]="selectedNotification" [options]="rowsPerPage" (onChange)="onChangeRowsPerPagesNotifications($event)"></p-dropdown>
                <label class="pl-1">
                  {{ "cargaMasivaDatosCurriculares.numRegistros.literal" | translate }}
                </label>
                <div class="ml-3 selectAll">
                  <p-checkbox (onChange)="onChangeSelectAllNotifications()" [(ngModel)]="selectAllNotifications" binary="true" label="{{ 'tablas.literal.seleccionarTodo' | translate }}"
                    name="groupname">
                  </p-checkbox>
                </div>
                <label class="ml-3 seleccionMultiple" [ngClass]="{
                      ' seleccion-multiple': selectMultipleNotifications
                    }" (click)="
                      isSelectMultipleNotifications();
                      selectedDatosNotifications = false
                    ">
                  <i class="pr-2 fa fa-mouse-pointer"></i>{{ "general.message.seleccion.multiple" | translate }}
                </label>
              </div>
            </ng-template>
          </p-dataTable>
        </div>

        <!-- Modo Nuevo-->
        <div *ngIf="pressNewNotificacion">
          <p-dataTable emptyMessage="{{ 'general.message.no.registros' | translate}}" [ngClass]="{ customCursor: selectMultipleNotifications }"
            [paginator]="true" #tableNotifications class="tabla-listado" [value]="datosNotificaciones" paginatorPosition="both"
            datakey="idNotificacion" [rows]="selectedNotification" [editable]="!pressNewNotificacion">

            <p-column [sortable]="true" [field]="colsNotifications[0].field" [header]="
              'menu.facturacion.plantillas'
                | translate
            " [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
              <ng-template let-col let-dato="rowData" pTemplate="body">
                <span *ngIf="dato[colsNotifications[0].field] != ''">{{ dato[colsNotifications[0].value] }}
                </span>
                <p-dropdown *ngIf="dato[colsNotifications[0].field] == ''" class="select-form" [(ngModel)]="newNotificacion.idPlantilla"
                  [options]="comboTemplates" placeholder="{{'tablas.literal.seleccionar' | translate}}" name="type" (onChange)="onChangeTemplates($event, dato)"
                  [filter]="true" filterBy="label,labelSinTilde" [showClear]="true"></p-dropdown>
              </ng-template>
            </p-column>

            <p-column [sortable]="true" [field]="colsNotifications[1].field" [header]="'envios.plantillas.literal.tipoenvio' | translate"
              [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
              <ng-template let-dato="rowData" pTemplate="body">
                <span *ngIf="dato[colsNotifications[1].field] != ''">{{ dato[colsNotifications[1].field] }}</span>
                <span *ngIf="dato[colsNotifications[1].field] == ''">{{ newNotificacion.tipoEnvio }}</span>
              </ng-template>
            </p-column>

            <p-column [sortable]="true" [field]="colsNotifications[2].field" [header]="'formacion.datosNotificaciones.cuando.cabecera' | translate"
              [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
              <ng-template let-dato="rowData" pTemplate="body">
                <span *ngIf="dato[colsNotifications[2].field] != ''">{{ dato[colsNotifications[2].field] }}</span>
                <input *ngIf="dato[colsNotifications[2].field] == ''" type="text" class="form-control" [(ngModel)]="newNotificacion.cuando"
                  type="number" min="0" pInputText>
              </ng-template>
            </p-column>

            <p-column [sortable]="true" [field]="colsNotifications[3].field" [header]="'formacion.datosNotificaciones.unidadMedida.literal' | translate"
              [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
              <ng-template let-dato="rowData" pTemplate="body">
                <span *ngIf="dato[colsNotifications[3].field] != ''">{{ dato[colsNotifications[3].value] }} </span>
                <p-dropdown *ngIf="dato[colsNotifications[3].field] == ''" class="select-form" [(ngModel)]="newNotificacion.idUnidadMedida"
                  [options]="comboMeasureUnit" [filter]="false" placeholder="{{'tablas.literal.seleccionar' | translate}}"
                  name="type" [showClear]="true"></p-dropdown>
              </ng-template>
            </p-column>

            <p-column [sortable]="true" [field]="colsNotifications[4].field" [header]="'formacion.datosNotificaciones.antesDespues.literal' | translate"
              [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
              <ng-template let-dato="rowData" pTemplate="body">
                <span *ngIf="dato[colsNotifications[4].field] != ''">{{ dato[colsNotifications[4].value] }}</span>

                <p-dropdown *ngIf="dato[colsNotifications[4].field] == ''" class="select-form" [(ngModel)]="newNotificacion.idTipoCuando"
                  [options]="comboAfterBefore" [filter]="false" placeholder="{{'tablas.literal.seleccionar' | translate}}"
                  name="type" [showClear]="true"></p-dropdown>
              </ng-template>
            </p-column>

            <ng-template pTemplate="paginatorLeft">
              <div class="mostrar d-flex text-right justify-content-end">
                <label class="pr-3 registros-totales">{{'informesycomunicaciones.plantillasenvio.ficha.mostrandoRegistros' | translate}} {{ tableNotifications.first
                  + 1 }} al {{ tableNotifications.first + tableNotifications.rows }} {{ 'informesycomunicaciones.plantillasenvio.ficha.deUnTotalDe'
                  | translate }} {{ tableNotifications.totalRecords }}</label>
                <label class="pr-3 numSeleccionados">{{'agenda.fichaCalendario.tablaNotificaciones.mostrandoRegistros' | translate }}: {{ numSelectedNotification
                  }}</label>
                <label>{{ "general.message.mostrar" | translate }}</label>
                <p-dropdown [(ngModel)]="selectedItem" [options]="rowsPerPage" (onChange)="onChangeRowsPerPagesNotifications($event)"></p-dropdown>
                <label class="pl-1">
                  {{ "cargaMasivaDatñosCurriculares.numRegistros.literal" | translate }}
                </label>
              </div>
            </ng-template>
          </p-dataTable>
        </div>
      </div>
    </div>
    <div *ngIf="esFichaActiva('notify')" class="card-footer">
      <div class="text-right main-button">
        <button *ngIf="!historico" (click)="getHistoricEventNotifications(); selectedDatosNotifications=[]" pButton type="button"
          icon="fa fa-history" iconPos="left" label="{{ 'general.message.mostrarHistorico' | translate}}" [disabled]="editNotificacion || pressNewNotificacion"></button>
        <button *ngIf="historico" (click)="getEventNotifications()" pButton type="button" icon="fa fa-undo" iconPos="left" label="{{'general.message.ocultarHistorico' | translate}}"></button>
        <button pButton (click)="restNotifications()" type="button" icon="fa fa-undo" iconPos="left" label="{{ 'general.boton.restablecer'| translate }}"
          [disabled]="tipoAccesoLectura || isEventoCumplidoOrCancelado || (!editNotificacion && !pressNewNotificacion)"></button>
        <button *ngIf="!editNotificacion" pButton (click)="saveNotification()" type="button" icon="far fa-save" iconPos="left" label="{{ 'general.boton.guardar' | translate }}"
          [disabled]="tipoAccesoLectura || isEventoCumplidoOrCancelado || validateNotification() || !pressNewNotificacion"></button>
        <button *ngIf="editNotificacion" pButton (click)="saveNotification()" type="button" icon="far fa-save" iconPos="left" label="{{ 'general.boton.guardar' | translate }}"
          [disabled]="tipoAccesoLectura || isEventoCumplidoOrCancelado"></button>
        <button (click)="deleteNotification(selectedDatosNotifications)" pButton type="button" icon="fa fa-trash-alt" iconPos="left"
          label="{{ 'general.boton.eliminar' | translate}}" [disabled]="tipoAccesoLectura || isEventoCumplidoOrCancelado || !deleteNotificacion"></button>
        <button pButton (click)="newNotification()" type="button" icon="fa fa-plus" iconPos="left" label="{{
                'general.boton.new' | translate }}" [disabled]="tipoAccesoLectura || isEventoCumplidoOrCancelado || editNotificacion || pressNewNotificacion || (selectMultipleNotifications || selectAllNotifications) || historico"></button>
      </div>
    </div>
  </div>


  <!-- TERJETAS FORMADORES-->
  <div class="card" *ngIf="isFormacionCalendar">
    <!-- Cabecera -->
    <div class="card-header header-ficha" (click)="abreCierraFicha('formadores')">
      <div *ngIf="!esFichaActiva('formadores')" class="form-row">
        <div class="col-lg-1 col-md-2">
          <div class="img-colegiado">
            <i class="fa fa-users icon-ficha"></i>
          </div>
        </div>
        <div class="col-lg-11 col-md-10">
          <div class="d-flex justify-content-start mb-1">
            <label class="mr-auto title-ficha">{{'agenda.fichaEventos.datosFormadores.cabecera' | translate}}</label>
          </div>
          <div *ngIf="results.length < 5 && results.length != 0" class="d-flex justify-content-between">
            <label *ngFor="let formador of results">
              {{ 'administracion.parametrosGenerales.literal.nombre' | translate }}:
              <span>{{ formador.nombreCompleto }}</span>
            </label>
            <i class="fa fa-angle-down float-right"></i>
          </div>
          <div *ngIf="results.length >= 5" class="d-flex justify-content-between">
            <label>{{ 'agenda.fichaEvento.tarjetaNotificaciones.resumen.numFormadores' | translate }}:
              <span>{{ results.length }}</span>
            </label>
            <i class="fa fa-angle-down float-right"></i>
          </div>
          <div *ngIf="results.length == 0" class="d-flex justify-content-between">
            <label>{{ 'agenda.fichaEvento.tarjetaNotificaciones.resumen.numFormadores' | translate }}:
              <span>0</span>
            </label>
            <i class="fa fa-angle-down float-right"></i>
          </div>
        </div>
      </div>
      <div *ngIf="esFichaActiva('formadores')" class=" header-ficha-open d-flex justify-content-start align-items-center">
        <div class="img-colegiado">
          <i class="fa fa-users icon-ficha"></i>
        </div>
        <label class="title-ficha">{{'agenda.fichaEventos.datosFormadores.cabecera' | translate}}</label>
        <i class="fa fa-angle-up ml-auto"></i>
      </div>
    </div>

    <!-- Cuerpo-->
    <div class="card-body card-body-ficha" *ngIf="esFichaActiva('formadores')">
      <div class="row">
        <div class="col-lg-11 col-md-11">
          <p-autoComplete #autocomplete [(ngModel)]="results" [suggestions]="formadoresSuggest" [minLength]="1" field="nombreCompleto"
            [multiple]="true" (onSelect)="visiblePanelOnSelect()" (onUnselect)="resetSuggestTrainers()" (onBlur)="visiblePanelBlur($event)"
            [style]="{'width':'100%'}" [disabled]="isEventoCancelado">
            <ng-template let-formadoresSelecionados pTemplate="selectedItem">
              <div class="ui-autocomplete-multiple-container ui-widget ui-inputtext ui-corner-all ng-star-inserted li ui-state-highlight"
                [ngStyle]="{'background': formadoresSelecionados.color, 'margin': marginPx, 'border': bw }">
                <span style="color: white">{{ formadoresSelecionados.nombreCompleto }}</span>
              </div>
            </ng-template>
          </p-autoComplete>
        </div>
        <div class="col-lg-1 col-md-1">
          <div class="text-left main-button">
            <button pButton (click)="filterTrainersMultiple()" type="button" icon="fa fa-plus" iconPos="left" label="{{'general.boton.new' | translate }}"
              [disabled]="isEventoCancelado || tipoAccesoLectura || !formadoresDistintosCheck()"></button>
          </div>
        </div>
      </div>
    </div>
    <div class="card-footer" *ngIf="esFichaActiva('formadores')">
      <div class="text-right main-button">
        <button pButton (click)="restTrainers()" type="button" icon="fa fa-undo" iconPos="left" label="{{ 'general.boton.restablecer'| translate }}"
          [disabled]="tipoAccesoLectura || !formadoresDistintosCheck() || isEventoCancelado"></button>
        <button pButton (click)="guardarFormadores()" type="button" icon="far fa-save" iconPos="left" label="{{ 'general.boton.guardar' | translate }}"
          [disabled]="tipoAccesoLectura || !formadoresDistintosCheck() || isEventoCancelado"></button>
      </div>
    </div>
  </div>

  <!-- TARJETAS ASISTENCIA-->
  <div class="card" *ngIf="isFormacionCalendar">
    <!-- Cabecera -->
    <div class="card-header header-ficha" (click)="abreCierraFicha('asistencia')">
      <div *ngIf="!esFichaActiva('asistencia')" class="form-row">
        <div class="col-lg-1 col-md-2">
          <div class="img-colegiado">
            <i class="fa fa-list icon-ficha"></i>
          </div>
        </div>
        <div class="col-lg-11 col-md-10">
          <div class="d-flex justify-content-start mb-1">
            <label class="mr-auto title-ficha">{{'agenda.fichaEventos.datosAsistencia.asistencia' | translate}}</label>
          </div>
          <div class="d-flex justify-content-between">
            <label>{{ 'agenda.fichaEvento.tarjetaNotificaciones.resumen.numAsistentes' | translate }}:
              <span>{{ datosAsistencia.length }}</span>
            </label>
            <i class="fa fa-angle-down float-right"></i>
          </div>
        </div>
      </div>
      <div *ngIf="esFichaActiva('asistencia')" class=" header-ficha-open d-flex justify-content-start align-items-center">
        <div class="img-colegiado">
          <i class="fa fa-list icon-ficha"></i>
        </div>
        <label class="title-ficha">{{'agenda.fichaEventos.datosAsistencia.asistencia' | translate}}</label>
        <i class="fa fa-angle-up ml-auto"></i>
      </div>
    </div>

    <!-- Cuerpo-->
    <div class="card-body card-body-ficha" *ngIf="esFichaActiva('asistencia')">
      <div class="row">
        <p-dataTable emptyMessage="{{ 'general.message.no.registros' | translate}}" [ngClass]="{'customCursor': selectMultipleAsistencia}"
          [(selection)]="selectedDatosAsistencia" pageLinks="4" dataKey="idPersona" [responsive]="true" selectionMode="multiple"
          #tableAsistencia class="tabla-listado" [value]="datosAsistencia" [sortOrder]="sortO" [paginator]="true" paginatorPosition="both"
          [rows]="selectedAsistencia">
          <p-column *ngFor="let col of colsAsistencia" [sortable]="true " [field]="col.field" [header]="col.header | translate" filterPlaceholder="{{'general.boton.search' | translate}}"
            [filter]="true" filterMatchMode="contains">

            <ng-template *ngIf="col.field =='asistencia'" pTemplate="body" let-dato="rowData">
              <p-dropdown class="select-form" [(ngModel)]="dato[col.field]" [options]="comboAsistencia" [filter]="false" placeholder="{{'tablas.literal.seleccionar' | translate }}"
                name="type" [disabled]="tipoAccesoLectura || isEventoCancelado" (onChange)="setAssistanceUpdate(dato)" [showClear]="true"></p-dropdown>
            </ng-template>

          </p-column>

          <ng-template pTemplate="paginatorLeft">
            <div class="mostrar d-flex text-right justify-content-end">
              <label class="pr-3 registros-totales">{{'informesycomunicaciones.plantillasenvio.ficha.mostrandoRegistros' | translate}} {{tableAsistencia.first
                + 1}} al {{tableAsistencia.first + tableAsistencia.rows}} de un total de {{tableAsistencia.totalRecords}}</label>
              <label class="pr-3 numSeleccionados">{{'agenda.fichaCalendario.tablaNotificaciones.mostrandoRegistros' | translate }}: {{numSelectedAsistencia}}</label>
              <label>{{ "general.message.mostrar" | translate}}</label>
              <p-dropdown [(ngModel)]="selectedAsistencia" [options]="rowsPerPage" (onChange)="onChangeRowsPerPagesAsistencia($event)"></p-dropdown>
              <label class="pl-1"> {{"cargaMasivaDatosCurriculares.numRegistros.literal" | translate}}</label>
              <div class="ml-3 selectAll">
                <p-checkbox (onChange)="onChangeSelectAllAsistencias()" [(ngModel)]="selectAllAsistencias" binary="true" label="{{'tablas.literal.seleccionarTodo' | translate}}"
                  name="groupname"></p-checkbox>
              </div>
              <label class="ml-3 seleccionMultiple" [ngClass]="{'seleccion-multiple': selectMultipleAsistencia}" (click)="isSelectMultipleAsistencia(); selectedDatosAsistencia=false">
                <i class="pr-2 fa fa-mouse-pointer"></i>{{ "general.message.seleccion.multiple" | translate}}</label>
            </div>
          </ng-template>


        </p-dataTable>
      </div>
    </div>
    <div class="card-footer" *ngIf="esFichaActiva('asistencia')">
      <div class="text-right main-button">
        <p-fileUpload #pUploadFile chooseLabel="{{ 'general.boton.cargar.archivo' | translate }}" name="file" mode="basic" accept=".xls"
          multiple="multiple" (onSelect)="getFile($event)" auto="true" [disabled]="tipoAccesoLectura || blockAsistencia || isEventoCancelado">
        </p-fileUpload>
        <button pButton type="button" (click)="downloadTemplateFile()" icon="fa fa-download" iconPos="left" label="{{ 'general.boton.download' | translate }}"
          [disabled]="tipoAccesoLectura || blockAsistencia || isEventoCumplido"></button>
        <button pButton type="button" (click)="unCheckAsist()" [disabled]="selectedDatosAsistencia == '' || tipoAccesoLectura || blockAsistencia || isEventoCancelado"
          icon="fa fa-times" iconPos="left" label="{{ 'agenda.fichaEventos.datosAsistencia.desmarcar' | translate }}"></button>
        <button pButton type="button" (click)="checkAsist()" [disabled]="selectedDatosAsistencia == '' || tipoAccesoLectura || blockAsistencia || isEventoCancelado"
          icon="fa fa-check" iconPos="left" label="{{'agenda.fichaEventos.datosAsistencia.marcar' | translate }}"></button>
        <button pButton type="button" (click)="saveAssistancesCourse()" icon="far fa-save" iconPos="left" label="{{ 'general.boton.guardar' | translate }}"
          [disabled]="tipoAccesoLectura || blockAsistencia || isEventoCancelado"></button>
      </div>
    </div>
  </div>
  <div class="text-right main-button">
    <button (click)="backTo()" pButton type="button" icon="fa fa-angle-left" iconPos="left" label="{{ 'general.boton.volver' | translate}}"></button>
  </div>

  <app-dialog></app-dialog>
  <div *ngIf="progressSpinner " class="overlay-spinner ">
    <div class="loader "></div>
  </div>

  <div *ngIf="progressSpinner2" class="overlay-spinner">
    <div class="loader "></div>
  </div>