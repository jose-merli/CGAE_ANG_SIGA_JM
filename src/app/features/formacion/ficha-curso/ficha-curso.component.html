<p-growl [(value)]="msgs" (onHover)="clear()" life="30000"></p-growl>
<app-dialog></app-dialog>

<div class="busqueda-container" id="top">
  <div class="header-title">
    <i class="fa fa-square"></i>
    <p>{{ "menu.formacion" | translate}}
      <i class="fa fa-angle-right"> </i>{{ 'menu.formacion.buscarCursos' | translate}}</p>
    <p> &nbsp;
      <i class="fa fa-angle-right"> </i>{{ 'formacion.fichaCurso.cabecera' | translate }}</p>
  </div>
  <!-- TARJETA RESUMEN FIJA -->
<app-tarjeta-resumen-fija class="pb-50" [titulo]="'justiciaGratuita.oficio.turnos.inforesumen'" [chincheta]="true" [datos]="datosTarjetaResumen" [enlaces] = "enlacesTarjetaResumen" [icono]="iconoTarjetaResumen"
(modoEdicionSend)="modoEdicionSend($event)" (isOpen)="isOpenReceive($event)"></app-tarjeta-resumen-fija>
<!-- FIN TARJETA RESUMEN FIJA -->
  <!-- TARJETA DATOS GENERALES -->
  <div class="card" id="datosGen">
    <!-- Cabecera -->
    <div class="card-header header-ficha" >
      <div *ngIf="!esFichaActiva('generales')" class="form-row">
        <div class="col-lg-1 col-md-2">
          <div class="img-colegiado">
            <i class="fa fa-file-pdf icon-ficha"></i>
          </div>
        </div>
        <div class="col-lg-11 col-md-10">
          <div class="d-flex justify-content-start mb-1">
            <label (click)="abreCierraFicha('generales')" class="mr-auto title-ficha">{{ "general.message.datos.generales" | translate }}
            </label>
          </div>
          <div class="d-flex justify-content-between">
            <label>{{ 'administracion.parametrosGenerales.literal.nombre' | translate }}:
              <span>{{ curso.nombreCurso }}</span>
            </label>
            <label>{{ 'formacion.fichaCursos.datosGenerales.codigo' | translate }}:
              <span>{{ curso.codigoCurso }}</span>
            </label>
            <label>{{ 'form.busquedaCursos.literal.estado' | translate }}:
              <span>{{ curso.estado }}</span>
            </label>
            <label>{{ 'formacion.fichaCursos.datosGenerales.resumen.periodoInscripcion' | translate }}
              <span>{{ curso.fechaInscripcionDesde }} - {{ curso.fechaInscripcionHasta }}</span>
            </label>
            <label>{{ 'formacion.fichaCursos.datosGenerales.resumen.periodoImparticion' | translate }}
              <span>{{ curso.fechaImparticionDesde }} - {{ curso.fechaImparticionHasta }}</span>
            </label>
            <i (click)="abreCierraFicha('generales')" class="fa fa-angle-down float-right"></i>
          </div>
        </div>
      </div>
      <div *ngIf="esFichaActiva('generales')" class=" header-ficha-open d-flex justify-content-start align-items-center">

        <div class="img-colegiado">
          <i class="fa fa-file-pdf icon-ficha"></i>
        </div>
        <label (click)="abreCierraFicha('generales')" class="title-ficha">{{ "general.message.datos.generales" | translate }}
        </label>
        <i (click)="abreCierraFicha('generales')" class="fa fa-angle-up ml-auto"></i>
      </div>
    </div>

    <!-- Cuerpo -->
    <div class="card-body card-body-ficha" *ngIf="esFichaActiva('generales')">
      <div class="form-row mb-3">
        <div class="bloque col-lg-4 col-md-4">
          <div class="row mb-3">
            <label class="ml-2">
              <strong>{{'censo.consultaDatosGenerales.cabecera' | translate}}</strong>
            </label>
          </div>
          <div class="row mb-4">
            <div class="col-lg-6 col-md-6">
              <label>{{ 'administracion.parametrosGenerales.literal.nombre' | translate}} (*)</label>
              <input type="text" #nombre class="form-control" pInputText name="nombre" [disabled]="!activacionEditar" [(ngModel)]="curso.nombreCurso"

              />
            </div>
            <div class="col-lg-6 col-md-6">
              <label>{{ 'formacion.fichaCursos.datosGenerales.codigo' | translate }} (*)</label>
              <input type="text" class="form-control" pInputText name="codigo" [disabled]="fieldNoEditable || !activacionEditar" [(ngModel)]="curso.codigoCurso"
              />

            </div>
          </div>
          <div class="row mb-4">
            <div class="col-lg-6 col-md-6">
              <label>{{ 'formacion.fichaCursos.datosGenerales.visibilidad' | translate}} (*)</label>
              <p-dropdown class="select-form" [disabled]="!activacionEditar" [(ngModel)]='curso.idVisibilidad' [options]="comboVisibilidad"
                [filter]="true" filterBy="label,labelSinTilde" (onChange)="onChangeSelectVisibilidad($event)" placeholder="{{'general.boton.seleccionar' | translate}}"
                [showClear]="true">
              </p-dropdown>
            </div>
            <div class="col-lg-6 col-md-6">
              <label>{{ 'censo.busquedaClientesAvanzada.literal.colegio' | translate}} (*)</label>
              <p-dropdown #colegio [disabled]="fieldNoEditable || !activacionEditar" class="select-form" placeholder="{{'general.boton.seleccionar' | translate}}"
                [(ngModel)]='curso.colegio' [options]="comboColegios" [filter]="true" filterBy="label,labelSinTilde" (onChange)="onChangeSelectColegio($event) "
                placeholder="{{'general.boton.seleccionar' | translate}}" [showClear]="true"></p-dropdown>

            </div>
          </div>
          <div class="row mb-4">
            <div class="col-lg-6 col-md-6">
              <label>{{'censo.busquedaClientesAvanzada.literal.tipoCliente' | translate}} (*)</label>
              <!-- <p-autoComplete #autocompleteService [(ngModel)]="resultsService" [disabled]="!activacionEditar"
                [suggestions]="suggestService" [minLength]="1" field="label" [multiple]="true"
                [style]="{'width':'100%'}" (onFocus)="filterServices($event)" (onBlur)="visiblePanelBlur($event)"
                (completeMethod)="filterLabelsMultiple($event)">
                <ng-template let-servicesSelecionados pTemplate="selectedItem">
                  <div class="ui-autocomplete-multiple-container ui-widget ui-inputtext ui-corner-all ng-star-inserted li ui-state-highlight"
                    [ngStyle]="{'background': servicesSelecionados.color, 'margin': marginPx, 'border': bw }">
                    <span style="color: white">{{ servicesSelecionados.label }}</span>
                  </div>
                </ng-template>  
              </p-autoComplete> -->

              <p-dropdown [disabled]="!activacionEditar" class="select-form" [(ngModel)]="curso.tipoServicios" [options]="comboService"
                [filter]="true" filterBy="label,labelSinTilde" placeholder="{{'general.boton.seleccionar' | translate}}" [showClear]="true"></p-dropdown>
            </div>
            <div class="col-lg-6 col-md-6">
              <label>{{ 'form.busquedaCursos.literal.estado' | translate}} (*)</label>
              <p-dropdown placeholder="-" class="select-form" [(ngModel)]='curso.idEstado' [options]="comboEstados" [filter]="true" filterBy="label,labelSinTilde"
                [disabled]="fieldNoEditable || !activacionEditar">
              </p-dropdown>
            </div>
          </div>
          <div class="row mb-4">
            <div class="col-lg-12 col-md-12">
              <label>{{'administracion.parametrosGenerales.literal.descripcion' | translate}} (*)</label>
              <editor #editor apiKey="{{apiKey}}" [init]="editorConfig" [(ngModel)]="curso.descripcionEstado"></editor>
            </div>
          </div>
        </div>
        <div class="bloque col-lg-4 col-md-4">
          <div class="row mb-3">
            <label>
              <strong>{{ 'formacion.fichaCurso.datosGestion.cabecera' | translate }}</strong>
            </label>
          </div>
          <div class="row mb-4">
            <div class="col-lg-6 col-md-6">
              <label>{{ 'formacion.fichaCurso.datosGenerales.fechaInicioInscripcion' | translate }} (*)</label>
              <app-fecha #fechaInicioInscripcion [(value)]="curso.fechaInscripcionDesdeDate" [maxDate]="curso.fechaInscripcionHastaDate"
                [disabled]="!activacionEditar" (valueFocus)="showMessageEditInitInscriptionEvent($event)" (click)="showMessageEditInitInscriptionEvent($event)"></app-fecha>
            </div>
            <div class="col-lg-6 col-md-6">
              <label>{{ 'formacion.fichaCurso.datosGenerales.fechaFinInscripcion' | translate }} (*)</label>
              <app-fecha #fechaFinInscripcion [(value)]="curso.fechaInscripcionHastaDate" [minDate]="curso.fechaInscripcionDesdeDate" (valueFocus)="showMessageEditEndInscriptionEvent($event)"
                (click)="showMessageEditEndInscriptionEvent($event)" [disabled]="!activacionEditar"></app-fecha>

            </div>
          </div>
          <div class="row mb-4">
            <div class="col-lg-6 col-md-6">
              <label>{{ 'formacion.fichaCurso.datosGenerales.fechaInicioImparticion' | translate }}</label>
              <app-fecha [minDate]="curso.fechaInscripcionHastaDate" [(value)]="curso.fechaImparticionDesdeDate" [disabled]="fieldNoEditable || !activacionEditar"
                (valueChangeSelected)="fillFechaInicioImparticion($event)" (valueChangeInput)="fillFechaInicioImparticion($event)"></app-fecha>
            </div>
            <div class="col-lg-6 col-md-6">
              <label>{{ 'formacion.fichaCurso.datosGenerales.fechaFinImparticion' | translate }}</label>
              <app-fecha [minDate]="curso.fechaImparticionDesdeDate" [(value)]="curso.fechaImparticionHastaDate" [disabled]="fieldNoEditable || !activacionEditar"
                (valueChangeSelected)="fillFechaFinImparticion($event)" (valueChangeInput)="fillFechaFinImparticion($event)"></app-fecha>
            </div>
          </div>
          <div class="row mb-4">
            <div class="col-lg-6 col-md-6">
              <label>{{ 'formacion.fichaCursos.datosDeGestion.plazasDisponibles' | translate}}</label>
              <input class="form-control paddingInput" type="number" min="0" name="tipo" [disabled]="!activacionEditar" [(ngModel)]="curso.plazasDisponibles"
              />

            </div>
            <div class="col-lg-6 col-md-6">
              <label>{{ 'formacion.fichaCursos.datosDeGestion.minimoAsistencia' | translate }}</label>
              <i class="fa fa-question" [pTooltip]="sesionesExistentes" tooltipPosition="bottom"></i>

              <input class="form-control paddingInput" type="number" min="0" name="asistencia" [disabled]="!activacionEditar" [(ngModel)]="curso.minimoAsistencia"
              />

            </div>
            <!-- numero Sesiones  numeroSesiones-->
          </div>
          <div class="row mb-4">
            <div class="col-lg-12 col-md-12">
              <label>{{'agenda.fichaEventos.datosGenerales.lugar' | translate}}</label>
              <input type="text" class="form-control" pInputText name="lugar" [disabled]="!activacionEditar" [(ngModel)]="curso.lugar"
              />

            </div>
          </div>
          <div class="row mb-4">
            <div class="col-lg-12 col-md-12">
              <label>{{ 'formacion.fichaCurso.datosGenerales.autovalidacionInscripciones' | translate }}</label>
              <p-checkbox binary="true" [disabled]="!activacionEditar" [(ngModel)]="curso.autovalidacion"></p-checkbox>
            </div>
          </div>
        </div>
        <div class="bloque col-lg-4 col-md-4">
          <div class="row mb-3">
            <label>
              <strong> {{'formacion.fichaCursos.datosGenerales.datosAdicionales.cabecera' | translate}}</strong>
            </label>
          </div>
          <div class="row mb-4">
            <div class="col-lg-12 col-md-12">
              <label>{{'formacion.fichaCursos.datosGenerales.datosAdicionales.documentacionAdjunta' | translate}}</label>
              <div *ngIf="edicionDocumentoAdjunto" class="ui-inputgroup">
                <input type="text" class="form-control" pInputText name="adjunto" [disabled]="!activacionEditar" [(ngModel)]="curso.adjunto"
                />
                <button (click)="editDocumentoAdjunto()" pButton type="button" icon="fas fa-check" [disabled]="!activacionEditar" class="ui-button-warn"></button>
              </div>
              <div *ngIf="!edicionDocumentoAdjunto" class="ui-inputgroup">
                <a *ngIf="curso.adjunto != undefined && curso.adjunto != '' && curso.adjunto.substring(0,4) == 'http'" [href]="curso.adjunto"
                  class="col-11" target="_blank">{{curso.adjunto}}</a>
                <a *ngIf="curso.adjunto != undefined && curso.adjunto != '' && curso.adjunto.substring(0,4) != 'http'" [href]="'http://'+curso.adjunto"
                  class="col-11" target="_blank">{{curso.adjunto}}</a>
                <span *ngIf="curso.adjunto == undefined || curso.adjunto == ''" class="col-11">{{curso.adjunto}}</span>
                <button (click)="editDocumentoAdjunto()" pButton type="button" icon="fas fa-pencil-alt" [disabled]="!activacionEditar" class="ui-button-warn button-edit"></button>
              </div>
            </div>
          </div>
          <div class="row mb-4">
            <div class="col-lg-12 col-md-12">
              <label>{{ 'form.busquedaCursos.literal.temas' | translate}}</label>
              <p-autoComplete #autocompleteTopics [(ngModel)]="resultsTopics" [suggestions]="suggestTopics" [minLength]="1" field="label"
                [multiple]="true" [style]="{'width':'100%'}" (onFocus)="filterTopics($event)" (onBlur)="visiblePanelBlurTopics($event)"
                [disabled]="!activacionEditar" (completeMethod)="filterLabelsMultipleTopics($event)">
                <ng-template let-topicsSelecionados pTemplate="selectedItem">
                  <div class="ui-autocomplete-multiple-container ui-widget ui-inputtext ui-corner-all ng-star-inserted li ui-state-highlight"
                    [ngStyle]="{'background': topicsSelecionados.color, 'margin': marginPx, 'border': bw}">
                    <span style="color: white">{{ topicsSelecionados.label }}</span>
                  </div>
                </ng-template>
              </p-autoComplete>
            </div>
          </div>
          <div class="row mb-4">
            <div class="col-lg-12 col-md-12">
              <label>{{'formacion.fichaCursos.datosGenerales.datosAdicionales.informacionAdicional' | translate}}</label>
              <div *ngIf="edicionInformacionAdicional" class="ui-inputgroup">
                <input type="text" class="form-control" pInputText name="adicional" [disabled]="!activacionEditar" [(ngModel)]="curso.adicional"
                />
                <button (click)="editInformacionAdicional()" pButton type="button" icon="fas  fa-check" [disabled]="!activacionEditar" class="ui-button-warn"></button>
              </div>
              <div *ngIf="!edicionInformacionAdicional" class="ui-inputgroup">
                <a *ngIf="curso.adicional != undefined && curso.adicional != ''" [href]="curso.adicional" class="col-11" target="_blank">{{curso.adicional}}</a>
                <span *ngIf="curso.adicional == undefined || curso.adicional == ''" class="col-11">{{curso.adicional}}</span>
                <button (click)="editInformacionAdicional()" pButton type="button" icon="fas fa-pencil-alt" [disabled]="!activacionEditar"
                  class="ui-button-warn button-edit"></button>
              </div>
            </div>
          </div>
          <div class="row mb-4">
            <div class="col-lg-12 col-md-12">
              <label>{{'formacion.fichaCursos.datosGenerales.datosAdicionales.encuestaSatisfaccion' | translate}}</label>
              <div *ngIf="edicionEncuestaSatisfaccion" class="ui-inputgroup">

                <input type="text" class="form-control" pInputText name="encuesta" [disabled]="!activacionEditar" [(ngModel)]="curso.encuesta"
                />
                <button (click)="editEncuestaSatisfaccion()" pButton type="button" icon="fas  fa-check" [disabled]="!activacionEditar" class="ui-button-warn"></button>
              </div>
              <div *ngIf="!edicionEncuestaSatisfaccion" class="ui-inputgroup">
                <a *ngIf="curso.encuesta != undefined && curso.encuesta != ''" [href]="curso.encuesta" class="col-11" target="_blank">{{curso.encuesta}}</a>
                <span *ngIf="curso.encuesta == undefined || curso.encuesta == ''" class="col-11">{{curso.encuesta}}</span>
                <button (click)="editEncuestaSatisfaccion()" pButton type="button" icon="fas fa-pencil-alt" [disabled]="!activacionEditar"
                  class="ui-button-warn button-edit"></button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="card-footer" *ngIf="esFichaActiva('generales')">
      <div class="text-right main-button">
        <!-- Botón cancelar -->

        <button (click)="cancelCourse()" pButton type="button" icon="fa fa-ban" iconPos="left" label="{{'general.boton.cancel' | translate}}"
          [disabled]="!controlBotonesEstado('Cancelar')"></button>

        <!-- Botón finalizar -->

        <button (click)="finishCourse()" pButton type="button" icon="fa fa-stop" iconPos="left" label="{{'general.boton.finalizar' | translate}}"
          [disabled]="!controlBotonesEstado('Finalizar')"></button>

        <!-- Botón desanunciar -->

        <button pButton type="button" icon="fa fa-bell-slash" iconPos="left" label="{{'form.busquedaCursos.literal.boton.desanunciar' | translate}}"
          [disabled]="!controlBotonesEstado('Desanunciar')" (click)="releaseCourse()"></button>

        <!-- Botón anunciar -->

        <button pButton type="button" icon="fa fa-bell" iconPos="left" label="{{'form.busquedaCursos.literal.boton.anunciar' | translate}}"
          [disabled]="!controlBotonesEstado('Anunciar')" (click)="announceCourse()"></button>


        <!-- Botón inscripción -->
        <button pButton type="button" icon="fa fa-caret-square-o-up" iconPos="left" label="{{ 'formacion.fichaCurso.boton.inscripcion' | translate }}"
          [disabled]="!controlBotonesEstado('Inscripcion')" (click)="irInscripcion()"></button>

        <!-- Botón guardar -->
        <button pButton type="button" icon="far fa-save" iconPos="left" label="{{ 'general.boton.guardar' | translate}}" (click)="saveCourse()"
          [disabled]="validateCourse() || !activacionEditar"></button>
      </div>
    </div>
  </div>

  <!-- TARJETA PRECIOS -->
  <div class="card" id="precios">
    <!-- Cabecera -->
    <div class="card-header header-ficha" >
      <div *ngIf="!esFichaActiva('price')" class="form-row">
        <div class="col-lg-1 col-md-2">
          <div class="img-colegiado">
            <i class="fa fa-usd icon-ficha"></i>
          </div>
        </div>
        <div class="col-lg-11 col-md-10">
          <div class="d-flex justify-content-start mb-1">
            <label (click)="abreCierraFicha('price')" class="mr-auto title-ficha">{{'formacion.fichaCurso.tarjetaPrecios.precios' | translate}}</label>
          </div>
          <div *ngIf="datosPrices.length < 5 && datosPrices.length != 0" class="d-flex justify-content-between">
            <label *ngFor="let precio of datosPrices">
              {{ 'formacion.fichaCurso.tarjetaPrecios.importe' | translate }}:
              <span>{{ precio.importe }} </span> - {{ 'administracion.parametrosGenerales.literal.descripcion' | translate }}:
              <span>{{ precio.descripcion }}</span>
            </label>
            <i (click)="abreCierraFicha('price')" class="fa fa-angle-down float-right"></i>
          </div>
          <div *ngIf="datosPrices.length >= 5" class="d-flex justify-content-between">
            <label>{{ 'formacion.fichaCursos.tarjetaPrecios.resumen.numRegistros' | translate }}:
              <span>{{ datosPrices.length }}</span>
            </label>
            <i class="fa fa-angle-down float-right"></i>
          </div>
          <div *ngIf="datosPrices.length == 0" class="d-flex justify-content-between">
            <label>{{ 'formacion.fichaCursos.tarjetaPrecios.resumen.numRegistros' | translate }}:
              <span>0</span>
            </label>
            <i class="fa fa-angle-down float-right"></i>
          </div>
        </div>
      </div>

      <div *ngIf="esFichaActiva('price')" class=" header-ficha-open d-flex justify-content-start align-items-center">
        <div class="img-colegiado">
          <i class="fa fa-usd icon-ficha"></i>
        </div>
        <label (click)="abreCierraFicha('price')" class="title-ficha">{{'formacion.fichaCurso.tarjetaPrecios.precios' | translate}}</label>
        <i (click)="abreCierraFicha('price')" class="fa fa-angle-up ml-auto"></i>
      </div>
    </div>
    <!-- Cuerpo -->
    <div class="card-body card-body-ficha" *ngIf="esFichaActiva('price')">
      <div class="row">
        <p-dataTable emptyMessage="{{ 'general.message.no.registros' | translate}}" [ngClass]="{ customCursor: selectMultiplePrices }"
          [(selection)]="selectedDatosPrices" (onRowSelect)="actualizaSeleccionadosPrices(selectedDatosPrices)" (onRowUnselect)="actualizaSeleccionadosPrices(selectedDatosPrices)"
          pageLinks="4" dataKey="idPrices" [responsive]="true" selectionMode="multiple" #tablePrices class="tabla-listado"
          [value]="datosPrices" [sortOrder]="sortO" [paginator]="true" paginatorPosition="both" [rows]="selectedPrices">

          <p-column *ngFor="let col of colsPrices" [sortable]="true" [field]="col.field" [header]="col.header | translate" filterPlaceholder="{{'general.boton.search' | translate}}"
            [filter]="true" filterMatchMode="contains">

            <ng-template *ngIf="col.field =='importe'"  let-datoH="rowData"  pTemplate="body">
              <div [ngStyle]="{'text-align': 'right'}">
                <span>{{datoH[col.field] | number:'1.2-2'}} €</span>

              </div>
            </ng-template>

          </p-column>
          <ng-template pTemplate="paginatorLeft">
            <div class="mostrar d-flex text-right justify-content-end">
              <label class="pr-3 registros-totales">{{'informesycomunicaciones.plantillasenvio.ficha.mostrandoRegistros' | translate}} {{ tablePrices.first + 1
                }} al {{ tablePrices.first + tablePrices.rows }} de un total de {{ tablePrices.totalRecords }}</label>
              <label class="pr-3 numSeleccionados">{{'agenda.fichaCalendario.tablaNotificaciones.mostrandoRegistros' | translate }}: {{ numSelectedPrices }}</label>
              <label>{{ "general.message.mostrar" | translate }}</label>
              <p-dropdown [(ngModel)]="selectedPrices" [options]="rowsPerPage" (onChange)="onChangeRowsPerPagesPrices($event)"></p-dropdown>
              <label class="pl-1">
                {{ "cargaMasivaDatosCurriculares.numRegistros.literal" | translate }}
              </label>
              <div class="ml-3 selectAll">
                <p-checkbox (onChange)="onChangeSelectAllPrices()" [(ngModel)]="selectAllPrices" binary="true" label="{{ 'tablas.literal.seleccionarTodo' | translate }}"
                  name="groupname"></p-checkbox>
              </div>
              <label class="ml-3 seleccionMultiple" [ngClass]="{ 'seleccion-multiple': selectMultiplePrices }" (click)="
                    isSelectMultiplePrices(); selectedDatosPrices = false">
                <i class="pr-2 fa fa-mouse-pointer"></i>{{ "general.message.seleccion.multiple" | translate }}</label>
            </div>
          </ng-template>
        </p-dataTable>
      </div>
    </div>
  </div>

  <!-- TERJETAS FORMADORES -->
  <div class="card" id="formadores">
    <!-- Cabecera -->
    <div class="card-header header-ficha">
      <div *ngIf="!esFichaActiva('formadores')" class="form-row">
        <div class="col-lg-1 col-md-2">
          <div class="img-colegiado">
            <i class="fa fa-users icon-ficha"></i>
          </div>
        </div>
        <div class="col-lg-11 col-md-10">
          <div class="d-flex justify-content-start mb-1">
            <label (click)="abreCierraFicha('formadores')" class="mr-auto title-ficha">{{'agenda.fichaEventos.datosFormadores.cabecera' | translate}}</label>
          </div>
          <div *ngIf="datosFormadores.length < 4 && datosFormadores.length != 0" class="d-flex justify-content-between">
            <label *ngFor="let formador of datosFormadores">
              {{ 'administracion.parametrosGenerales.literal.nombre' | translate }}:
              <span>{{ formador.nombre }} {{ formador.apellidos }}</span> - {{ 'administracion.usuarios.literal.rol' | translate
              }}:
              <span>{{ formador.rol }}</span>
            </label>
            <i (click)="abreCierraFicha('formadores')" class="fa fa-angle-down float-right"></i>
          </div>
          <div *ngIf="datosFormadores.length >= 4" class="d-flex justify-content-between">
            <label>{{ 'agenda.fichaEvento.tarjetaNotificaciones.resumen.numFormadores' | translate }}:
              <span>{{ datosFormadores.length }}</span>
            </label>
            <i (click)="abreCierraFicha('formadores')" class="fa fa-angle-down float-right"></i>
          </div>
          <div *ngIf="datosFormadores.length == 0" class="d-flex justify-content-between">
            <label>{{ 'agenda.fichaEvento.tarjetaNotificaciones.resumen.numFormadores' | translate }}:
              <span>0</span>
            </label>
            <i (click)="abreCierraFicha('formadores')" class="fa fa-angle-down float-right"></i>
          </div>
        </div>
      </div>

      <div *ngIf="esFichaActiva('formadores')" class=" header-ficha-open d-flex justify-content-start align-items-center">
        <div class="img-colegiado">
          <i class="fa fa-users icon-ficha"></i>
        </div>
        <label (click)="abreCierraFicha('formadores')" class="title-ficha">{{'agenda.fichaEventos.datosFormadores.cabecera' | translate}}</label>
        <i (click)="abreCierraFicha('formadores')" class="fa fa-angle-up ml-auto"></i>
      </div>
    </div>

    <!-- Cuerpo -->
    <div class="card-body card-body-ficha" *ngIf="esFichaActiva('formadores')">
      <div class="row">
        <div *ngIf="(selectMultipleFormadores || selectAllFormadores || !activacionEditar) && !pressNewFormador">
          <p-dataTable emptyMessage="{{ 'general.message.no.registros' | translate}}" [ngClass]="{ customCursor: selectMultipleFormadores }"
            dataKey="idPersona" selectionMode="multiple" [(selection)]="selectedDatosFormadores" [responsive]="true" #tableFormadores
            class="tabla-listado" [paginator]="true" (onRowSelect)="actualizaSeleccionadosFormadores(selectedDatosFormadores)"
            (onRowUnselect)="actualizaSeleccionadosFormadores(selectedDatosFormadores)" [value]="datosFormadores" [sortOrder]="1"
            [paginator]="true" paginatorPosition="both" [rows]="selectedFormadores" [editable]="selectMultipleFormadores">
            <p-column *ngFor="let col of colsFormadores" [sortable]="true" [field]="col.field" [header]="col.header | translate" filterPlaceholder="{{'general.boton.search' | translate}}"
              [filter]="true" filterMatchMode="contains">
            </p-column>

            <ng-template pTemplate="paginatorLeft">
              <div class="mostrar d-flex text-right justify-content-end">

                <label class="pr-3 registros-totales">{{'informesycomunicaciones.plantillasenvio.ficha.mostrandoRegistros' | translate}} {{ tableFormadores.first
                  + 1 }} al {{ tableFormadores.first + tableFormadores.rows }} {{ 'informesycomunicaciones.plantillasenvio.ficha.deUnTotalDe'
                  | translate }} {{ tableFormadores.totalRecords }}</label>
                <label class="pr-3 numSeleccionados">{{'agenda.fichaCalendario.tablaNotificaciones.mostrandoRegistros' | translate }}: {{ numSelectedFormadores
                  }}
                </label>
                <label>{{ "general.message.mostrar" | translate }}</label>
                <p-dropdown [(ngModel)]="selectedFormadores" [options]="rowsPerPage" (onChange)="onChangeRowsPerPagesFormadores($event)"></p-dropdown>
                <label class="pl-1">
                  {{ "cargaMasivaDatosCurriculares.numRegistros.literal" | translate }}
                </label>
                <div class="ml-3 selectAll">
                  <p-checkbox (onChange)="onChangeSelectAllFormadores()" [(ngModel)]="selectAllFormadores" binary="true" label="{{ 'tablas.literal.seleccionarTodo' | translate }}"
                    name="groupname"></p-checkbox>
                </div>
                <label class="ml-3 seleccionMultiple" [ngClass]="{
                      ' seleccion-multiple': selectMultipleFormadores
                    }" (click)="
                      isSelectMultipleFormadores();
                      selectedDatosFormadores = false
                    ">
                  <i class="pr-2 fa fa-mouse-pointer"></i>{{ "general.message.seleccion.multiple" | translate }}
                </label>
              </div>
            </ng-template>
          </p-dataTable>
        </div>

        <!-- Editar Formador -->
        <div *ngIf="!selectMultipleFormadores && !pressNewFormador && !selectAllFormadores && activacionEditar">
          <p-dataTable emptyMessage="{{ 'general.message.no.registros' | translate}}" [ngClass]="{ customCursor: selectMultipleFormadores }"
            [paginator]="true" #tableFormadores class="tabla-listado" [value]="datosFormadores" paginatorPosition="both" datakey="idPersona"
            [(selection)]="selectedDatosFormadores" [rows]="selectedFormadores" [editable]="!selectMultipleFormadores">
            <p-column [sortable]="true" [field]="colsFormadores[0].field" [header]="
                  'administracion.parametrosGenerales.literal.nombre'
                    | translate
                " [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">

            </p-column>

            <p-column [sortable]="true" [field]="colsFormadores[1].field" [header]="
                  'gratuita.mantenimientoTablasMaestra.literal.apellidos'
                    | translate
                " [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">

            </p-column>

            <!-- (onChange)="onChangeEdit($event)" -->

            <p-column [sortable]="true" [field]="colsFormadores[2].select" [header]="'administracion.usuarios.literal.rol' | translate"
              [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
              <ng-template let-dato="rowData" pTemplate="body">
                <p-dropdown (onChange)="onChangeTutor($event, dato)" class="select-form" [(ngModel)]="dato[colsFormadores[2].select]" [options]="comboRoles"
                  [filter]="false" placeholder="{{'general.boton.seleccionar' | translate}}" name="type"></p-dropdown>
              </ng-template>
            </p-column>

            <p-column [sortable]="true" [field]="colsFormadores[3].select" [header]="
                  'censo.busquedaClientesAvanzada.literal.tipoCliente'
                    | translate

                " [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
              <ng-template pTemplate="body" let-dato="rowData">
                <p-dropdown (onChange)="onChangeEdit($event, dato)" class="select-form" [(ngModel)]="dato[colsFormadores[3].select]" [options]="comboTipoCoste"
                  [filter]="false" placeholder="{{'general.boton.seleccionar' | translate}}" name="type"></p-dropdown>
              </ng-template>
            </p-column>

            <p-column [sortable]="true" [field]="colsFormadores[4].field" [header]="'censo.alterMutua.literal.tarifa' | translate" [filter]="true"
              filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
              <ng-template let-col let-dato="rowData" pTemplate="body">
                <input (ngModelChange)="editFormadorTable($event, dato)" [value]="dato[colsFormadores[4].field]" [(ngModel)]="dato[colsFormadores[4].field]"
                  class="form-control paddingInputTable" type="number" min="0" />
              </ng-template>
            </p-column>

            <!-- <p-column
                [editable]="false"
                [sortable]="true"
                [field]="colsFormadores[5].field"
                [header]="
                  'form.busquedaCursos.literal.tutorResponsable' | translate
                "
                [filter]="true"
                filterPlaceholder="{{'general.boton.search' | translate}}"
                filterMatchMode="contains"
              >
                <ng-template pTemplate="body" let-dato="rowData">
                  <p-checkbox
                    (onChange)="onChangeTutor($event, dato)"
                    [(ngModel)]="dato[colsFormadores[5].field]"
                    binary="true"
                    name="groupname"
                  ></p-checkbox>
                </ng-template>
              </p-column> -->

            <ng-template pTemplate="paginatorLeft">
              <div class="mostrar d-flex text-right justify-content-end">
                <label class="pr-3 registros-totales">{{'informesycomunicaciones.plantillasenvio.ficha.mostrandoRegistros' | translate}} {{ tableFormadores.first
                  + 1 }} al {{ tableFormadores.first + tableFormadores.rows }} {{ 'informesycomunicaciones.plantillasenvio.ficha.deUnTotalDe'
                  | translate }} {{ tableFormadores.totalRecords }}</label>
                <label class="pr-3 numSeleccionados">{{'agenda.fichaCalendario.tablaNotificaciones.mostrandoRegistros' | translate }}: {{ numSelectedFormadores
                  }}
                </label>
                <label>{{ "general.message.mostrar" | translate }}</label>
                <p-dropdown [(ngModel)]="selectedFormadores" [options]="rowsPerPage" (onChange)="onChangeRowsPerPagesFormadores($event)"></p-dropdown>
                <label class="pl-1">
                  {{ "cargaMasivaDatosCurriculares.numRegistros.literal" | translate }}
                </label>
                <div class="ml-3 selectAll">
                  <p-checkbox (onChange)="onChangeSelectAllFormadores($event)" [(ngModel)]="selectAllFormadores" binary="true" label="{{ 'tablas.literal.seleccionarTodo' | translate }}"
                    name="groupname">
                  </p-checkbox>
                </div>
                <label class="ml-3 seleccionMultiple" [ngClass]="{
                      'seleccion-multiple': selectMultipleFormadores
                    }" (click)="
                      isSelectMultipleFormadores();
                      selectedDatosFormadores = false
                    ">
                  <i class="pr-2 fa fa-mouse-pointer"></i>{{ "general.message.seleccion.multiple" | translate }}
                </label>
              </div>
            </ng-template>
          </p-dataTable>
        </div>

        <!-- Nuevo Formador -->
        <div *ngIf="pressNewFormador">
          <p-dataTable emptyMessage="{{ 'general.message.no.registros' | translate}}" [ngClass]="{ customCursor: selectMultipleFormadores }"
            [paginator]="true" #tableFormadores class="tabla-listado" [value]="datosFormadores" paginatorPosition="both" datakey="idPersona"
            [rows]="selectedFormadores" [editable]="!pressNewFormador">
            <p-column [sortable]="true" [field]="colsFormadores[0].field" [header]="
                  'administracion.parametrosGenerales.literal.nombre'
                    | translate
                " [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
              <ng-template let-col let-dato="rowData" pTemplate="body">
                <span>{{ dato[colsFormadores[0].field] }}</span>
                <input *ngIf="dato[colsFormadores[0].field] == ''" [value]="dato[colsFormadores[0].field]" [(ngModel)]="newFormadorCourse.nombre"
                  type="text" class="form-control descolorear" pInputText />
              </ng-template>
            </p-column>

            <p-column [sortable]="true" [field]="colsFormadores[1].field" [header]="
                  'gratuita.mantenimientoTablasMaestra.literal.apellidos'
                    | translate
                " [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
              <ng-template let-col let-dato="rowData" pTemplate="body">
                <span>{{ dato[colsFormadores[1].field] }}</span>
                <input *ngIf="dato[colsFormadores[1].field] == ''" [value]="dato[colsFormadores[1].field]" [(ngModel)]="newFormadorCourse.apellidos"
                  type="text" class="form-control descolorear" pInputText />
              </ng-template>
            </p-column>

            <p-column [sortable]="true" [field]="colsFormadores[2].field" [header]="'administracion.usuarios.literal.rol' | translate"
              [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
              <ng-template let-dato="rowData" pTemplate="body">
                <span *ngIf="dato[colsFormadores[2].field] != ''">{{ dato[colsFormadores[2].field] }}
                </span>

                <p-dropdown *ngIf="dato[colsFormadores[2].field] == ''" class="select-form" [(ngModel)]="newFormadorCourse.idRol" [options]="comboRoles"
                  [filter]="false" placeholder="{{'general.boton.seleccionar' | translate}}" name="type" [disabled]="!activacionEditar"
                  (onChange)="onChangeTutor($event, dato)"></p-dropdown>
              </ng-template>
            </p-column>

            <p-column [sortable]="true" [field]="colsFormadores[3].field" [header]="
                  'censo.busquedaClientesAvanzada.literal.tipoCliente'
                    | translate
                " [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
              <ng-template pTemplate="body" let-dato="rowData">
                <span *ngIf="dato[colsFormadores[3].field] != ''">{{ dato[colsFormadores[3].field] }}
                </span>

                <p-dropdown *ngIf="dato[colsFormadores[3].field] == ''" class="select-form" [(ngModel)]="newFormadorCourse.idTipoCoste" [options]="comboTipoCoste"
                  [filter]="false" [disabled]="!activacionEditar" placeholder="{{'general.boton.seleccionar' | translate}}"
                  name="type">
                </p-dropdown>
              </ng-template>
            </p-column>

            <p-column [sortable]="true" [field]="colsFormadores[4].field" [header]="'censo.alterMutua.literal.tarifa' | translate" [filter]="true"
              filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
              <ng-template let-col let-dato="rowData" pTemplate="body">
                <span *ngIf="dato[colsFormadores[4].field] != ''">{{ dato[colsFormadores[4].field] }}
                </span>
                <input *ngIf="dato[colsFormadores[4].field] == '' && dato[colsFormadores[4].field] != '0'" [value]="dato[colsFormadores[4].field]"
                  [(ngModel)]="newFormadorCourse.tarifa" [disabled]="!activacionEditar" class="form-control paddingInputTable"
                  type="number" min="0" />
              </ng-template>
            </p-column>


            <ng-template pTemplate="paginatorLeft">
              <div class="mostrar d-flex text-right justify-content-end">
                <label class="pr-3 registros-totales">{{'informesycomunicaciones.plantillasenvio.ficha.mostrandoRegistros' | translate}} {{ tableFormadores.first
                  + 1 }} al {{ tableFormadores.first + tableFormadores.rows }} {{ 'informesycomunicaciones.plantillasenvio.ficha.deUnTotalDe'
                  | translate }} {{ tableFormadores.totalRecords }}</label>
                <label class="pr-3 numSeleccionados">{{'agenda.fichaCalendario.tablaNotificaciones.mostrandoRegistros' | translate }}: {{ numSelectedFormadores
                  }}
                </label>
                <label>{{ "general.message.mostrar" | translate }}</label>
                <p-dropdown [(ngModel)]="selectedItem" [options]="rowsPerPage" (onChange)="onChangeRowsPerPagesFormadores($event)"></p-dropdown>
                <label class="pl-1">
                  {{ "cargaMasivaDatñosCurriculares.numRegistros.literal" | translate }}
                </label>
              </div>
            </ng-template>
          </p-dataTable>
        </div>
      </div>
    </div>
    <div class="card-footer" *ngIf="esFichaActiva('formadores')">
      <div class="text-right main-button">
        <button pButton (click)="restTrainer()" type="button" icon="fa fa-undo" iconPos="left" label="{{ 'general.boton.restablecer'| translate }}"
          [disabled]="(!editFormador && !pressNewFormador) || isCursoFinalizado"></button>
        <button pButton (click)="saveTrainers()" type="button" icon="far fa-save" iconPos="left" [disabled]="((pressNewFormador  || !activacionEditar || !editFormador) && validateTrainer()) || !editFormador || !activacionEditar || isCursoFinalizado"
          label="{{ 'general.boton.guardar' | translate }}"></button>
        <button pButton (click)="deleteTrainer(selectedDatosFormadores)" type="button" icon="fa fa-trash-alt" iconPos="left" [disabled]="!activacionEditar || selectedDatosFormadores == '' || isCursoFinalizado"
          label="{{ 'general.boton.eliminar'| translate }}"></button>
        <button pButton (click)="newTrainer()" type="button" icon="fa fa-plus" iconPos="left" label="{{ 'general.boton.new'| translate }}"
          [disabled]="editFormador || isCursoFinalizado || !activacionEditar || pressNewFormador || selectMultipleFormadores "></button>
      </div>
    </div>
  </div>


<!-- TERJETAS INSCRIPCIONES -->
<div class="card" id="inscripciones">
  <!-- Cabecera -->
  <div *ngIf="!modoEdicion" class="card-header header-ficha">
    <div class="form-row">
      <div class="col-lg-1 col-md-2">
        <div class="img-colegiado">
          <i class="fa fa-pencil-square icon-ficha"></i>
        </div>
      </div>
      <div class="col-lg-11 col-md-10">
        <div class="d-flex justify-content-start mt-2">
          <label class="mr-auto title-ficha">
            {{ 'formacion.fichaCurso.inscripciones.cabecera' | translate }}
          </label>
        </div>
      </div>
    </div>
  </div>
  <div *ngIf="modoEdicion" class="card-header header-ficha" (click)="irBusquedaInscripcciones()">
    <div class="form-row">
      <div class="col-lg-1 col-md-2">
        <div class="img-colegiado">
          <i class="fa fa-pencil-square icon-ficha"></i>
        </div>
      </div>
      <div class="col-lg-11 col-md-10">
        <div class="d-flex justify-content-start mb-1">
          <label class="mr-auto title-ficha">
            {{ 'formacion.fichaCurso.inscripciones.cabecera' | translate }}
          </label>
        </div>
        <div class="d-flex justify-content-between">
          <label>{{ 'formacion.fichaCurso.inscripciones.pendientes' | translate }}:
            <span>{{ inscription.pendientes }}</span>
          </label>
          <label>{{ 'formacion.fichaCurso.inscripciones.aprobadas' | translate }}:
            <span>{{ inscription.aprobadas }}</span>
          </label>
          <label>{{ 'formacion.fichaCurso.inscripciones.rechazadas' | translate }}:
            <span>{{ inscription.rechazadas }}</span>
          </label>
          <label>{{ 'formacion.fichaCurso.inscripciones.canceladas' | translate }}:
            <span>{{ inscription.canceladas }}</span>
          </label>
          <label>{{ 'formacion.fichaCurso.inscripciones.plazasTotales' | translate }}:
            <span *ngIf="curso.plazasDisponibles != undefined">{{ curso.plazasDisponibles }}</span>
            <span *ngIf="curso.plazasDisponibles == undefined">0</span>
          </label>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- TERJETAS CERTIFICADOS -->
<div class="card" id="certificados">
  <!-- Cabecera -->
  <div class="card-header header-ficha">
    <div *ngIf="!esFichaActiva('certificate')" class="form-row">
      <div class="col-lg-1 col-md-2">
        <div class="img-colegiado">
          <i class="fa fa-certificate icon-ficha"></i>
        </div>
      </div>
      <div class="col-lg-11 col-md-10">
        <div class="d-flex justify-content-start mb-1">
          <label (click)="abreCierraFicha('certificate')" class="mr-auto title-ficha">{{'formacion.fichaInscripcion.datosCertificados.cabecera' | translate}}</label>
        </div>
        <div *ngIf="datosCertificates.length == 1" class="d-flex justify-content-between">
          <label>{{ 'administracion.parametrosGenerales.literal.nombre' | translate }}:
            <span>{{ datosCertificates[0].nombreCertificado }}</span>
          </label>
          <label>{{ 'form.busquedaCursos.literal.precio' | translate }}:
            <span>{{ datosCertificates[0].precio }}</span>
          </label>
          <label>{{ 'formacion.busquedaInscripcion.calificacion' | translate }}:
            <span>{{ datosCertificates[0].calificacion }}</span>
          </label>
          <i (click)="abreCierraFicha('certificate')" class="fa fa-angle-down float-right"></i>
        </div>
        <div *ngIf="datosCertificates.length >= 2" class="d-flex justify-content-between">
          <label>{{ 'formacion.fichaCursos.tarjetaCertificados.resumen.numCertificados' | translate }}:
            <span>{{ datosCertificates.length }}</span>
          </label>
          <i (click)="abreCierraFicha('certificate')" class="fa fa-angle-down float-right"></i>
        </div>
        <div *ngIf="datosCertificates.length == 0" class="d-flex justify-content-between">
          <label>{{ 'formacion.fichaCursos.tarjetaCertificados.resumen.numCertificados' | translate }}:
            <span>0</span>
          </label>
          <i (click)="abreCierraFicha('certificate')" class="fa fa-angle-down float-right"></i>
        </div>
      </div>
    </div>
    <div *ngIf="esFichaActiva('certificate')" class=" header-ficha-open d-flex justify-content-start align-items-center">
      <div class="img-colegiado">
        <i class="fa fa-certificate icon-ficha"></i>
      </div>
      <label (click)="abreCierraFicha('certificate')" class="title-ficha">{{'formacion.fichaInscripcion.datosCertificados.cabecera' | translate}}</label>
      <i (click)="abreCierraFicha('certificate')" class="fa fa-angle-up ml-auto"></i>
    </div>
  </div>

  <!-- Cuerpo -->
  <div class="card-body card-body-ficha" *ngIf="esFichaActiva('certificate')">
    <div class="row">
      <div *ngIf="(selectMultipleCertificates || selectAllCertificates  || !activacionEditar) && !pressNewCertificate">
        <p-dataTable emptyMessage="{{ 'general.message.no.registros' | translate}}" [ngClass]="{ customCursor: selectMultipleCertificates }"
          dataKey="idCertificadoCurso" selectionMode="multiple" [(selection)]="selectedDatosCertificates" [responsive]="true"
          #tableCertificates class="tabla-listado" [paginator]="true" (onRowSelect)="actualizaSeleccionadosCertificates(selectedDatosCertificates)"
          (onRoUnselect)="actualizaSeleccionadosCertificates(selectedDatosCertificates)" [value]="datosCertificates" [sortOrder]="1"
          [paginator]="true" paginatorPosition="both" [rows]="selectedCertificates" [editable]="selectMultipleCertificates">
          <p-column [sortable]="true" [field]="colsCertificates[0].field" [header]="
                  'menu.certificados'
                    | translate
                " [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
            <ng-template let-col let-dato="rowData" pTemplate="body">
              <span *ngIf="dato[colsCertificates[0].field] != ''">{{ dato[colsCertificates[0].value] }}
              </span>
            </ng-template>
          </p-column>

          <p-column [sortable]="true" [field]="colsCertificates[1].field" [header]="
                  'form.busquedaCursos.literal.precio'
                    | translate
                " [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
            <ng-template let-col let-dato="rowData" pTemplate="body">
              <span *ngIf="dato[colsCertificates[1].field] != ''">{{ dato[colsCertificates[1].field] }}
              </span>
            </ng-template>
          </p-column>

          <p-column [sortable]="true" [field]="colsCertificates[2].field" [header]="'formacion.busquedaInscripcion.calificacion' | translate"
            [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
            <ng-template let-dato="rowData" pTemplate="body">
              <span *ngIf="dato[colsCertificates[2].field] != ''">{{ dato[colsCertificates[2].value] }}
              </span>
            </ng-template>
          </p-column>

          <ng-template pTemplate="paginatorLeft">
            <div class="mostrar d-flex text-right justify-content-end">
              <label class="pr-3 registros-totales">{{'informesycomunicaciones.plantillasenvio.ficha.mostrandoRegistros' | translate}} {{ tableCertificates.first
                + 1 }} al {{ tableCertificates.first + tableCertificates.rows }} {{ 'informesycomunicaciones.plantillasenvio.ficha.deUnTotalDe'
                | translate }} {{ tableCertificates.totalRecords }}</label>
              <label class="pr-3 numSeleccionados">{{'agenda.fichaCalendario.tablaNotificaciones.mostrandoRegistros' | translate }}: {{ numSelectedCertificates
                }}
              </label>
              <label>{{ "general.message.mostrar" | translate }}</label>
              <p-dropdown [(ngModel)]="selectedCertificates" [options]="rowsPerPage" (onChange)="onChangeRowsPerPagesCertificates($event)"></p-dropdown>
              <label class="pl-1">
                {{ "cargaMasivaDatosCurriculares.numRegistros.literal" | translate }}
              </label>
              <div class="ml-3 selectAll">
                <p-checkbox (onChange)="onChangeSelectAllCertificates()" [(ngModel)]="selectAllCertificates" binary="true" label="{{ 'tablas.literal.seleccionarTodo' | translate }}"
                  name="groupname">
                </p-checkbox>
              </div>
              <label class="ml-3 seleccionMultiple" [ngClass]="{
                      ' seleccion-multiple': selectMultipleCertificates
                    }" (click)="
                      isSelectMultipleCertificates();
                      selectedDatosCertificates = false
                    ">
                <i class="pr-2 fa fa-mouse-pointer"></i>{{ "general.message.seleccion.multiple" | translate }}
              </label>
            </div>
          </ng-template>
        </p-dataTable>
      </div>

      <!-- Editar Certificate -->
      <div *ngIf="!selectMultipleCertificates && !pressNewCertificate && !selectAllCertificates && activacionEditar">

        <p-dataTable emptyMessage="{{ 'general.message.no.registros' | translate}}" [ngClass]="{ customCursor: selectMultipleCertificates }"
          [paginator]="true" #tableCertificates class="tabla-listado" [value]="datosCertificates" paginatorPosition="both"
          datakey="idCertificadoCurso" [(selection)]="selectedDatosCertificates" [rows]="selectedCertificates" [editable]="!selectMultipleCertificates"
          (onEdit)="editCertificateTable($event)">
          <p-column [sortable]="true" [field]="colsCertificates[0].field" [header]="
                  'menu.certificados'
                    | translate
                " [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
            <ng-template pTemplate="body" let-dato="rowData">
              <p-dropdown #dropdownCertificate class="select-form" [(ngModel)]="dato[colsCertificates[0].fieldClave]" [options]="comboCertificates"
                [filter]="false" placeholder="{{'tablas.literal.seleccionar' | translate}}" [disabled]="!activacionEditar"
                name="type" (onChange)="selectPriceModeEdit($event, dato)"></p-dropdown>
            </ng-template>
          </p-column>

          <p-column [sortable]="true" [field]="colsCertificates[1].field" [header]="
                  'form.busquedaCursos.literal.precio'
                    | translate
                " [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
          </p-column>

          <p-column [sortable]="true" [field]="colsCertificates[2].field" [header]="
                  'formacion.busquedaInscripcion.calificacion'
                    | translate
                " [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
            <ng-template pTemplate="body" let-dato="rowData">
              <p-dropdown class="select-form" [(ngModel)]="dato[colsCertificates[2].field]" [options]="comboCalificaciones" [filter]="false"
                placeholder="{{'tablas.literal.seleccionar' | translate}}" [disabled]="!activacionEditar" name="type" (onChange)="editCertificateTable($event, dato)"></p-dropdown>
            </ng-template>
          </p-column>

          <ng-template pTemplate="paginatorLeft">
            <div class="mostrar d-flex text-right justify-content-end">
              <label class="pr-3 registros-totales">{{'informesycomunicaciones.plantillasenvio.ficha.mostrandoRegistros' | translate}} {{ tableCertificates.first
                + 1 }} al {{ tableCertificates.first + tableCertificates.rows }} {{ 'informesycomunicaciones.plantillasenvio.ficha.deUnTotalDe'
                | translate }} {{ tableCertificates.totalRecords }}</label>
              <label class="pr-3 numSeleccionados">{{'agenda.fichaCalendario.tablaNotificaciones.mostrandoRegistros' | translate }}: {{ numSelectedCertificates
                }}
              </label>
              <label>{{ "general.message.mostrar" | translate }}</label>
              <p-dropdown [(ngModel)]="selectedCertificates" [options]="rowsPerPage" (onChange)="onChangeRowsPerPagesCertificates($event)"></p-dropdown>
              <label class="pl-1">
                {{ "cargaMasivaDatosCurriculares.numRegistros.literal" | translate }}
              </label>
              <div class="ml-3 selectAll">
                <p-checkbox (onChange)="onChangeSelectAllCertificates($event)" [(ngModel)]="selectAllCertificates" binary="true" label="{{ 'tablas.literal.seleccionarTodo' | translate}}"
                  name="groupname"></p-checkbox>
              </div>
              <label class="ml-3 seleccionMultiple" [ngClass]="{
                      'seleccion-multiple': selectMultipleCertificates
                    }" (click)="
                      isSelectMultipleCertificates();
                      selectedDatosCertificates = false
                    ">

                <i class="pr-2 fa fa-mouse-pointer"></i>{{ "general.message.seleccion.multiple" | translate }}
              </label>
            </div>
          </ng-template>
        </p-dataTable>
      </div>

      <!-- Nuevo Certificado -->
      <div *ngIf="pressNewCertificate">

        <p-dataTable emptyMessage="{{ 'general.message.no.registros' | translate}}" [ngClass]="{ customCursor: selectMultipleCertificates }"
          [paginator]="true" #tableCertificates class="tabla-listado" [value]="datosCertificates" paginatorPosition="both"
          datakey="idCertificadoCurso" [rows]="selectedCertificates" [editable]="!pressNewCertificate">
          <p-column [sortable]="true" [field]="colsCertificates[0].field" [header]="
                  'menu.certificados'
                    | translate
                " [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
            <ng-template let-col let-dato="rowData" pTemplate="body">
              <span *ngIf="dato[colsCertificates[0].field] != ''">{{ dato[colsCertificates[0].value] }}
              </span>

              <p-dropdown *ngIf="dato[colsCertificates[0].field] == ''" class="select-form" [(ngModel)]="newCertificate.clave" [options]="comboCertificates"
                [filter]="false" placeholder="{{'tablas.literal.seleccionar' | translate}}" [disabled]="!activacionEditar"
                name="type" (onChange)="selectPriceModeNew($event)"></p-dropdown>
            </ng-template>
          </p-column>

          <p-column [sortable]="true" [field]="colsCertificates[1].field" [header]="
                  'form.busquedaCursos.literal.precio'
                    | translate
                " [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
            <ng-template let-col let-dato="rowData" pTemplate="body">
              <span *ngIf="dato[colsCertificates[1].field] != ''">{{ dato[colsCertificates[1].field] }}
              </span>
              <span *ngIf="dato[colsCertificates[1].field] == ''">{{ newCertificate.precio }}</span>
            </ng-template>
          </p-column>

          <p-column [sortable]="true" [field]="colsCertificates[2].field" [header]="'formacion.busquedaInscripcion.calificacion' | translate"
            [filter]="true" filterPlaceholder="{{'general.boton.search' | translate}}" filterMatchMode="contains">
            <ng-template let-dato="rowData" pTemplate="body">
              <span *ngIf="dato[colsCertificates[2].field] != ''">{{ dato[colsCertificates[2].value] }}
              </span>

              <p-dropdown *ngIf="dato[colsCertificates[2].field] == ''" class="select-form" [(ngModel)]="newCertificate.idCalificacion"
                [options]="comboCalificaciones" [filter]="false" placeholder="{{'tablas.literal.seleccionar' | translate}}"
                [disabled]="!activacionEditar" name="type">
              </p-dropdown>
            </ng-template>
          </p-column>


          <ng-template pTemplate="paginatorLeft">
            <div class="mostrar d-flex text-right justify-content-end">
              <label class="pr-3 registros-totales">{{'informesycomunicaciones.plantillasenvio.ficha.mostrandoRegistros' | translate}} {{ tableCertificates.first
                + 1 }} al {{ tableCertificates.first + tableCertificates.rows }} {{ 'informesycomunicaciones.plantillasenvio.ficha.deUnTotalDe'
                | translate }} {{ tableCertificates.totalRecords }}</label>
              <label class="pr-3 numSeleccionados">{{'agenda.fichaCalendario.tablaNotificaciones.mostrandoRegistros' | translate }}: {{ numSelectedCertificates
                }}
              </label>
              <label>{{ "general.message.mostrar" | translate }}</label>
              <p-dropdown [(ngModel)]="selectedItemCertificates" [options]="rowsPerPage" (onChange)="onChangeRowsPerPagesCertificates($event)"></p-dropdown>
              <label class="pl-1">
                {{ "cargaMasivaDatñosCurriculares.numRegistros.literal" | translate }}
              </label>
            </div>
          </ng-template>
        </p-dataTable>
      </div>
    </div>
  </div>
  <div class="card-footer" *ngIf="esFichaActiva('certificate')">
    <div class="text-right main-button">
      <button [disabled]="!editCertificate && !pressNewCertificate" pButton (click)="restCertificates()" type="button" icon="fa fa-undo"
        iconPos="left" label="{{ 'general.boton.restablecer'| translate }}"></button>
      <button pButton (click)="saveCertificateCourse()" type="button" icon="far fa-save" iconPos="left" label="{{ 'general.boton.guardar' | translate }}"
        [disabled]="((pressNewCertificate  || !activacionEditar || !editCertificate) && validateCertificate()) || !editCertificate || !activacionEditar"></button>
      <button [disabled]="selectedDatosCertificates == '' || !activacionEditar" pButton (click)="deleteCertificates(selectedDatosCertificates)"
        type="button" icon="fa fa-trash-alt" iconPos="left" label="{{ 'general.boton.eliminar'| translate }}"></button>
      <button [disabled]="selectMultipleCertificates || selectAllCertificates || (editCertificate && !pressNewCertificate) || !activacionEditar"
        pButton (click)="newCertificates()" type="button" icon="fa fa-plus" iconPos="left" label="{{ 'general.boton.new'| translate }}"></button>
    </div>
  </div>
</div>

<!-- TERJETAS SESIONES -->
<div class="card" id="sesiones">
  <!-- Cabecera -->
  <div class="card-header header-ficha" >
    <div *ngIf="!esFichaActiva('session')" class="form-row">
      <div class="col-lg-1 col-md-2">
        <div class="img-colegiado">
          <i class="fa fa-user icon-ficha"></i>
        </div>
      </div>
      <div class="col-lg-11 col-md-10">
        <div class="d-flex justify-content-start mb-1">
          <label (click)="abreCierraFicha('session')" class="mr-auto title-ficha">{{'formacion.fichaCursos.sesiones.cabecera' | translate}}</label>
        </div>
        <div *ngIf="datosSessions.length >= 1" class="d-flex justify-content-between">
          <label>{{ 'formacion.fichaCursos.tarjetaSesiones.resumen.numSesiones' | translate }}:
            <span>{{ datosSessions.length }}</span>
          </label>
          <label>{{ 'agenda.fichaEventos.datosGenerales.fechaInicio' | translate }}:
            <span>{{ datosSessions[0].fechaHoraInicio }}</span>
          </label>
          <label>{{ 'agenda.fichaEventos.datosGenerales.lugar' | translate }}:
            <span>{{ datosSessions[0].lugar }}</span>
          </label>
          <label>{{ 'agenda.fichaEventos.datosFormadores.cabecera' | translate }}:
            <span>{{ datosSessions[0].formadores }}</span>
          </label>
          <i (click)="abreCierraFicha('session')" class="fa fa-angle-down float-right"></i>
        </div>
        <div *ngIf="datosSessions.length == 0" class="d-flex justify-content-between">
          <label>{{ 'formacion.fichaCursos.tarjetaSesiones.resumen.numSesiones' | translate }}:
            <span>0</span>
          </label>
          <i (click)="abreCierraFicha('session')" class="fa fa-angle-down float-right"></i>
        </div>
      </div>
    </div>
    <div *ngIf="esFichaActiva('session')" class=" header-ficha-open d-flex justify-content-start align-items-center">
      <div class="img-colegiado">
        <i class="fa fa-user icon-ficha"></i>
      </div>
      <label (click)="abreCierraFicha('session')" class="title-ficha">{{'formacion.fichaCursos.sesiones.cabecera' | translate}}</label>
      <i (click)="abreCierraFicha('session')" class="fa fa-angle-up ml-auto"></i>
    </div>
  </div>

  <!-- Cuerpo -->
  <div class="card-body card-body-ficha" *ngIf="esFichaActiva('session')">
    <div class="row">

      <p-dataTable emptyMessage="{{ 'general.message.no.registros' | translate}}" [ngClass]="{ customCursor: selectMultipleSessions }"
        [(selection)]="selectedDatosSessions" (onRowSelect)="irEditarSession(selectedDatosSessions)" (onRowUnselect)="actualizaSeleccionadosSessions(selectedDatosSessions)"
        pageLinks="4" dataKey="idEvento" [responsive]="true" selectionMode="multiple" #tableSessions class="tabla-listado"
        [value]="datosSessions" [sortOrder]="sortO" [paginator]="true" paginatorPosition="both" [rows]="selectedSessions">
        <p-column *ngFor="let col of colsSessions" [sortable]="true" [field]="col.field" [header]="col.header | translate" filterPlaceholder="{{'general.boton.search' | translate}}"
          [filter]="true" filterMatchMode="contains">
        </p-column>
        <ng-template pTemplate="paginatorLeft">
          <div class="mostrar d-flex text-right justify-content-end">
            <label class="pr-3 registros-totales">{{'informesycomunicaciones.plantillasenvio.ficha.mostrandoRegistros' | translate}} {{ tableSessions.first + 1
              }} al {{ tableSessions.first + tableSessions.rows }} de un total de {{ tableSessions.totalRecords }}</label>
            <label class="pr-3 numSeleccionados">{{'agenda.fichaCalendario.tablaNotificaciones.mostrandoRegistros' | translate }}: {{ numSelectedSessions }}</label>
            <label>{{ "general.message.mostrar" | translate }}</label>
            <p-dropdown [(ngModel)]="selectedSessions" [options]="rowsPerPage"></p-dropdown>
            <label class="pl-1">
              {{ "cargaMasivaDatosCurriculares.numRegistros.literal" | translate }}
            </label>
            <div class="ml-3 selectAll">
              <p-checkbox (onChange)="onChangeSelectAllSessions()" [(ngModel)]="selectAllSessions" binary="true" label="{{ 'tablas.literal.seleccionarTodo' | translate }}"
                name="groupname"></p-checkbox>
            </div>
            <label class="ml-3 seleccionMultiple" [ngClass]="{ 'seleccion-multiple': selectMultipleSessions }" (click)="
                  isSelectMultipleSessions(); selectedDatosSessions = false
                ">
              <i class="pr-2 fa fa-mouse-pointer"></i>{{ "general.message.seleccion.multiple" | translate }}</label>
          </div>
        </ng-template>
      </p-dataTable>
    </div>
  </div>
  <div class="card-footer" *ngIf="esFichaActiva('session')">
    <div class="text-right main-button">
      <button pButton type="button" icon="fa fa-close" (click)="cancelSessions()" iconPos="left" label="{{ 'general.boton.cancel' | translate}}"
        [disabled]="selectedDatosSessions == '' || !activacionEditar || isLetrado || isCursoFinalizado"></button>
      <button pButton type="button" icon="fa fa-reply-all" (click)="duplicateSession()" iconPos="left" label="{{ 'general.boton.duplicar' | translate}}"
        [disabled]="disabledDuplicate() || !activacionEditar || isLetrado || isCursoFinalizado"></button>
      <button pButton type="button" icon="fa fa-plus" (click)="newSession()" [disabled]="!activacionEditar || isLetrado  || isCursoFinalizado"
        iconPos="left" label="{{ 'general.boton.new' | translate}}"></button>
    </div>
  </div>
</div>

<!-- TERJETAS CARGA MASIVA INSCRIPCIONES -->
<div id="cargainscripciones">
<div *ngIf="!isLetrado" class="card" >
  <!-- Cabecera -->
  <div class="card-header header-ficha">
    <div *ngIf="!esFichaActiva('carga')" class="form-row">
      <div class="col-lg-1 col-md-2">
        <div class="img-colegiado">
          <i class="fa fa-upload icon-ficha"></i>
        </div>
      </div>
      <div class="col-lg-11 col-md-10">
        <div class="d-flex justify-content-start mb-1">
          <label (click)="abreCierraFicha('carga')" class="mr-auto title-ficha">{{ 'formacion.fichaCurso.cargaMasivaInscripciones.cabecera' | translate }}</label>

        </div>
        <div class="d-flex justify-content-between">
          <label>{{ 'formacion.fichaCursos.tarjetaCargasMasivas.resumen.numCargas' | translate }}:
            <span>{{ datosCargas.length }}</span>
          </label>
          <i (click)="abreCierraFicha('carga')" class="fa fa-angle-down float-right"></i>
        </div>
      </div>
    </div>
    <div *ngIf="esFichaActiva('carga')" class=" header-ficha-open d-flex justify-content-start align-items-center">

      <div class="img-colegiado">
        <i class="fa fa-upload icon-ficha"></i>
      </div>
      <label (click)="abreCierraFicha('carga')" class="title-ficha">{{ 'formacion.fichaCurso.cargaMasivaInscripciones.cabecera' | translate }}</label>
      <i (click)="abreCierraFicha('carga')" class="fa fa-angle-up ml-auto"></i>
    </div>
  </div>

  <!-- Cuerpo -->
  <div class="card-body card-body-ficha" *ngIf="esFichaActiva('carga')">
    <div class="row">
      <p-dataTable emptyMessage="{{ 'general.message.no.registros' | translate}}" [ngClass]="{'customCursor': selectMultipleCargas}"
        [(selection)]="selectedDatosCargas" pageLinks="4" dataKey="idCargaInscripcion" [responsive]="true" selectionMode="multiple"
        #tableCargas class="tabla-listado" [value]="datosCargas" [sortOrder]="sortO" (onRowSelect)="actualizaSeleccionadosCargas(selectedDatosCargas)"
        (onRowUnselect)="actualizaSeleccionadosCargas(selectedDatosCargas)" [paginator]="true" paginatorPosition="both" [rows]="selectedCargas">
        <p-column *ngFor="let col of colsCargas" [sortable]="true " [field]="col.field" [header]="col.header | translate" filterPlaceholder="{{'general.boton.search' | translate}}"
          [filter]="true" filterMatchMode="contains">



          <ng-template *ngIf="col.field == 'nombreFichero' || col.field == 'fechaCarga'" let-dato="rowData" pTemplate="body">
            <div *ngIf="setItalic(dato)">
              <span [ngStyle]="{'font-style': 'italic', 'font-weight':'bold', 'text-decoration':'line-through'}">{{dato[col.field]}}</span>
            </div>
            <div *ngIf="!setItalic(dato)">
              <span>{{dato[col.field]}}</span>
            </div>
          </ng-template>

          <ng-template *ngIf="col.field == 'numeroLineasTotales'" let-dato="rowData" pTemplate="body">
            <div *ngIf="setItalic(dato)">
              <span [ngStyle]="{'font-style': 'italic', 'font-weight':'bold', 'text-decoration':'line-through'}"> {{ dato[col.field] }} / {{ dato[col.field2] }}</span>
            </div>
            <div *ngIf="!setItalic(dato)">
              <span> {{ dato[col.field] }} / {{ dato[col.field2] }}</span>
            </div>
          </ng-template>

        </p-column>

        <ng-template pTemplate="paginatorLeft">
          <div class="mostrar d-flex text-right justify-content-end">
            <label class="pr-3 registros-totales">{{'informesycomunicaciones.plantillasenvio.ficha.mostrandoRegistros' | translate}} {{tableCargas.first + 1}}
              al {{tableCargas.first + tableCargas.rows}} {{ 'informesycomunicaciones.plantillasenvio.ficha.deUnTotalDe'
              | translate }} {{tableCargas.totalRecords}}
            </label>
            <label class="pr-3 numSeleccionados">{{'agenda.fichaCalendario.tablaNotificaciones.mostrandoRegistros' | translate }}: {{numSelectedCargas}}</label>
            <label>{{ "general.message.mostrar" | translate}}</label>
            <p-dropdown [(ngModel)]="selectedCargas" [options]="rowsPerPage" (onChange)="onChangeRowsPerPagesCargas($event)"></p-dropdown>
            <label class="pl-1"> {{"cargaMasivaDatosCurriculares.numRegistros.literal" | translate}}</label>
            <div class="ml-3 selectAll">
              <p-checkbox (onChange)="onChangeSelectAllCargas()" [(ngModel)]="selectAllCargas" binary="true" label="{{'tablas.literal.seleccionarTodo' | translate}}"
                name="groupname"></p-checkbox>
            </div>
            <label class="ml-3 seleccionMultiple" [ngClass]="{'seleccion-multiple': selectMultipleCargas}" (click)="isSelectMultipleCargas(); selectedDatosCargas=false">
              <i class="pr-2 fa fa-mouse-pointer"></i>{{ "general.message.seleccion.multiple" | translate}}</label>
          </div>
        </ng-template>

      </p-dataTable>
    </div>
  </div>
  <div class="card-footer" *ngIf="esFichaActiva('carga')">
    <div class="text-right main-button">

      <button *ngIf="!historico" (click)="getHistoricoCargas()" pButton type="button" icon="fa fa-history" iconPos="left" label="{{ 'general.message.mostrarHistorico' | translate}}"></button>
      <button *ngIf="historico" (click)="getMassiveLoadInscriptions()" pButton type="button" icon="fa fa-undo" iconPos="left" label="{{'general.message.ocultarHistorico' | translate}}"></button>

      <button pButton type="button" [disabled]="disabledDownload() || !activacionEditar || historico" (click)="autovalidateInscriptions(selectedDatosCargas)"
        icon="fa fa-check" iconPos="left" label="{{ 'formacion.boton.autovalidar' | translate }}"></button>

      <p-fileUpload #pUploadFile chooseLabel="{{ 'general.boton.cargar.archivo' | translate }}" name="file" mode="basic" accept=".xls"
        multiple="multiple" (onSelect)="getFile($event)" auto="true" [disabled]="!controlBotonesEstado('Inscripcion') || historico">
      </p-fileUpload>

      <button pButton type="button" (click)="downloadTemplateFile()" icon="fa fa-download" [disabled]="!controlBotonesEstado('DescargarPlantilla') || historico"
        iconPos="left" label="{{ 'general.boton.descargar.plantilla' | translate }}"></button>
      <button pButton type="button" [disabled]="disabledDownload() || !activacionEditar || historico" (click)="downloadFile(selectedDatosCargas)"
        icon="fa fa-download" iconPos="left" label="{{ 'general.boton.descargar.fichero' | translate }}"></button>
      <button pButton type="button" [disabled]="disabledOthersCargas() || !activacionEditar || historico" (click)="deleteInscriptions(selectedDatosCargas)"
        icon="fa fa-trash-alt" iconPos="left" label="{{ 'general.boton.borrarInscripciones' | translate }}"></button>

    </div>
  </div>
</div>
</div>
</div>
<div class="mt-3 text-right main-button" id="down">
  <button (click)="backTo()" pButton type="button " icon="fa fa-angle-left" iconPos="left" label="{{ 'general.boton.volver' | translate}}"></button>
</div>

<div *ngIf="progressSpinner" class="overlay-spinner">
  <div class="loader "></div>
</div>

<div *ngIf="progressSpinner2" class="overlay-spinner">
  <div class="loader "></div>
</div>