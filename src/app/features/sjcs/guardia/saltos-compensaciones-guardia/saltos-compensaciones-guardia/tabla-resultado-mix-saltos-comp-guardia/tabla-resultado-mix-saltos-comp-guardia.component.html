<p-growl [(value)]="msgs" (onHover)="clear()" life="30000"></p-growl>

<div class="card mt-3">
  <div class="card-body p-0 padding-paginador" #tablaFoco>

    <div class="padding-interior w-100">
      <app-paginador (perPage)="perPage($event)" (seleccionarTodo)="selectedAll($event)" (fromReg)="fromReg($event)"
        (toReg)="toReg($event)" [totalRegistros]="totalRegistros"></app-paginador>
    </div>

    <div class="table" matSort (matSortChange)="sortData($event)" #table>
      <div class="table-header ">
        <div class="table-header-child p-2" *ngFor="let cabecera of cabeceras; let j = index" #BorderedHeader>
          <div>
            <div [mat-sort-header]=cabecera.id>{{cabecera.name | translate}}</div>
            <input type="text" class="form-control" pInputTex [(ngModel)]="searchText[j]"
              (ngModelChange)="searchChange(j)" autocomplete="off" placeholder="Buscar">
          </div>
        </div>
      </div>
      <div *ngFor="let row of rowGroups | slice:from:to; let i = index; trackBy:trackByIdx" class="table-row child">
        <div (click)="selectRow(i)" class="table-row-wrapper hoverBlue"
          [ngClass]="{'hoverBlue2': isSelected(i), 'fixedBlue': seleccionarTodo}" #rowSelected>
          <div *ngFor="let cell of row['cells'] | slice:0:8; let z = index; trackBy:trackByIdx"
            class="table-cell p-2 selectedRowClass" [ngClass]="{'borders-child': isPar(i)}" #cellSelected>
            <div class="cell-wrapper selectedRowClass">

              <span class="w100 cell-value" *ngIf="cell.type == 'newinput'">
                <input type="text" class="form-control mt-2" pInputText [(ngModel)]="this.newInputValue[z]"
                  (change)="inputValueChange($event, i, z, cell)">
              </span>

              <span class="w100 cell-value" *ngIf="cell.type == 'input'">
                <input type="text" class="form-control mt-2" pInputText [(ngModel)]="cell.value"
                  (change)="inputChange($event, i, z)">
              </span>

              <span class="w100 cell-value" *ngIf="cell.type == 'text'"
                [ngClass]="{'setItalic': row.italic}">{{cell.value}}</span>

              <span class="w100 cell-value" *ngIf="cell.type == 'buttom'">
                <button pButton type="button" iconPos="left" [label]="cell.value"></button>
              </span>

              <span class="w100 cell-value" *ngIf="cell.type == 'checkbox'">
                <p-checkbox [ngModel]="validaCheck(cell.value)" binary="true">
                </p-checkbox>
              </span>

              <span class="w100 cell-value" *ngIf="cell.type == 'datePicker'">
                <app-fecha [(value)]="cell.value" [utc]="false"
                  (valueChangeSelected)="fillFechaIncorporacionDesde($event)"
                  (valueChangeInput)="fillFechaIncorporacionDesde($event)">
                </app-fecha>
              </span>

              <span class="w100 cell-value selectWrap" *ngIf="cell.type == 'select'">
                <p-dropdown autoWidth="false" class="center" [placeholder]="textFilter" [(ngModel)]="cell.value"
                  [options]="cell.combo" showClear="true" styleClass="widthAll">
                </p-dropdown>
              </span>

              <span class="w100 cell-value" *ngIf="cell.type == 'number'">{{cell.value}}</span>

              <span class="w100 cell-value" *ngIf="cell.type == 'link'">
                <a>{{cell.value}}</a>
              </span>

              <span class="w100 cell-value" *ngIf="cell.type == 'download'">
                <div (click)="showMsg('success', 'Documento descargado', '')"><i class="pointer fa fa-download"></i>
                </div>
              </span>

              <span class="w100 cell-value" *ngIf="cell.type == 'multiselect'">
                <p-multiSelect #{i} autoWidth="false" [(ngModel)]='cell.value' [selectedItemsLabel]="textSelected"
                  [defaultLabel]="textFilter" [options]="cell.combo" maxSelectedLabels="10" styleClass="widthAll"
                  [filter]="true" filterBy="label,labelSinTilde" (onChange)="onChangeMulti($event, i, cell)">
                </p-multiSelect>
              </span>

              <span class="w100 cell-value" *ngIf="cell.type == 'textarea'">
                <textarea pInputTextarea [(ngModel)]="cell.value" class="form-control"></textarea>
              </span>

            </div>
          </div>
        </div>
      </div>
    </div>

  </div>

  <div class="card-footer">
    <div class="text-right main-button butBottom mt10">

      <button *ngIf="!historico" (click)="toogleHistorico(true)" pButton type="button" icon="fa fa-history"
        iconPos="left" label="{{ 'general.message.mostrarHistorico' | translate}}"></button>

      <button *ngIf="historico" (click)="toogleHistorico(false)" pButton type="button" icon="fa fa-undo" iconPos="left"
        label="{{'general.message.ocultarHistorico' | translate}}"></button>

      <button pButton type="button" icon="far fa-save" iconPos="left" label="{{ 'general.boton.guardar' | translate}}"
        [disabled]="isDisabled" (click)="guardar()"></button>


      <button pButton type="button" icon="far fa-save" iconPos="left" label="{{ 'general.boton.anular' | translate}}"
        [disabled]="historico" (click)="anular()"></button>

      <button pButton type="button" icon="fa fa-plus" iconPos="left" label="{{ 'general.boton.new' | translate}}"
        [disabled]="!anySelected" (click)="nuevo()"></button>

      <button pButton type="button" icon="fa fa-trash-alt" iconPos="left"
        label="{{ 'general.boton.eliminar' | translate}}" [disabled]="!anySelected" (click)="delete()"></button>

      <button (click)="restablecer()" pButton type="button" icon="fa fa-undo" iconPos="left"
        label="{{ 'general.boton.restablecer' | translate}}"></button>
    </div>
  </div>
</div>
