<div class="center mb-3">
    <!--<mat-form-field appearance="fill">
        <mat-label>{{numCabeceras - info.value?.length}} <span>visibles</span></mat-label>
        <mat-select [formControl]="info" multiple [(value)]="selectedHeader"> 
          <mat-option *ngFor="let cabecera of cabeceras" [value]="cabecera.id">{{cabecera.name}}</mat-option>
        </mat-select>
      </mat-form-field>
      <span>Columnas</span>-->
    <p-multiSelect #mySelect [formControl]="info" [(ngModel)]='selectedHeader' [options]="cabeceras"
        [defaultLabel]="numColumnas + ' visibles'" optionLabel="name" optionValue="id" [displaySelectedLabel]="false">
    </p-multiSelect> Columnas
</div>
<div class="table" matSort (matSortChange)="sortData($event)" #table id="tablaResultadoDesplegable">
    <div class="table-header ">
        <div class="table-header-child p-2" *ngFor="let cabecera of cabeceras; let j = index" #BorderedHeader
            [ngClass]="{'collapse': cabeceraOculta(selectedHeader, cabecera.id, BorderedHeader, BorderedCell)}">
            <div>
                <div [mat-sort-header]=cabecera.id>{{cabecera.name}}</div>
                <input type="text" class="form-control" pInputTex [(ngModel)]="searchText[j]"
                    (ngModelChange)="searchChange(j)" autocomplete="off" placeholder="Buscar">
            </div>
        </div>
    </div>
    <div *ngFor="let rowGroup of rowGroups" class="table-row-group" #rowGroupEl>
        <div class="table-row parent">
            <span class="mr-2 arrow" (click)="rowGroupArrowClick(rowGroupEl, rowGroup.id)">
                <span (click)="iconClickChange(iconrightEl, icondownEl)" #iconrightEl><i
                        class="fas fa-chevron-right"></i></span>
                <span class="collapse" (click)="iconClickChange2(iconrightEl, icondownEl)" #icondownEl><i
                        class="fas fa-chevron-down"></i></span>
            </span>
            <div (click)="selectRow(rowSelected, rowGroup.id)" class="table-row-wrapper hoverBlue"
                [ngClass]="{'hoverBlue2': isSelected(rowGroup.id), 'fixedBlue': seleccionarTodo}" [id]="rowGroup.id"
                #rowSelected>

                <div *ngIf="!posicionOcultar(-1)" class="table-row-header p-2 selectedRowClass">
                    {{rowGroup.id}}
                </div>
                <div *ngFor="let cell of rowGroup.rows[0]['cells']; let z = index"
                    class="table-cell p-2 selectedRowClass" #BorderedCell [ngClass]="{'collapse':posicionOcultar(z)}"
                    #cellSelected>
                    <div class="cell-wrapper selectedRowClass">
                        <span class="column-title">{{cabeceras[z+1].name}}</span>
                        <span class="w100 cell-value" *ngIf="cell.type == 'text'">{{cell.value}}</span>
                        <span class="w100 cell-value" *ngIf="cell.type == 'buttom'"><button class="main-button" pButton
                                type="button" iconPos="left" [label]="cell.value"></button></span>
                        <span class="w100 cell-value" *ngIf="cell.type == 'checkbox'">
                            <p-checkbox [ngModel]="validaCheck(cell.value)" binary="true">
                            </p-checkbox>
                        </span>
                        <span class="w100 cell-value" *ngIf="cell.type == 'datePicker'">
                            <app-fecha [(value)]="fechaIncorporacionDesdeSelect" [utc]="false"
                                (valueChangeSelected)="fillFechaIncorporacionDesde($event)"
                                (valueChangeInput)="fillFechaIncorporacionDesde($event)">
                            </app-fecha>
                        </span>
                        <span class="w100 cell-value" *ngIf="cell.type == 'select'">
                            <app-selector class="wrapText center" [i]="0" [selector]="cell.value"
                                [textoVisible]="cell.value"></app-selector>
                        </span>
                        <span class="w100 cell-value" *ngIf="cell.type == 'number'">{{cell.value}}</span>
                        <span class="w100 cell-value" *ngIf="cell.type == 'link'"><a>{{cell.value}}</a></span>
                        <span class="w100 cell-value" *ngIf="cell.type == '5InputSelector'">
                            <input type="text" class="form-control " pInputText size="10" [placeholder]="cell.value[0]">
                            <input type="text" class="form-control " pInputText size="10" [placeholder]="cell.value[1]">
                            <input type="text" class="form-control " pInputText size="10" [placeholder]="cell.value[2]">
                            <input type="text" class="form-control " pInputText size="10" [placeholder]="cell.value[3]">
                            <app-selector [textoVisible]="cell.value[4]" [i]="0" [selector]="cell.value"></app-selector>
                        </span>
                        <span class="w100 cell-value" *ngIf="cell.type == '2SelectorInput'">
                            <app-selector [i]="0" [selector]="cell.value"></app-selector>
                            <input type="text" class="form-control mt-2" pInputText size="10"
                                [placeholder]="cell.value">
                        </span>
                        <span class="w100 cell-value" *ngIf="cell.type == 'input'"><input type="text"
                                class="form-control" pInputText size="10" [placeholder]="cell.value"></span>
                        <span class="w100 cell-value" *ngIf="cell.type == 'buttomSelect'">
                            <div>
                                <div class="main-button">
                                    <button pButton type="button" iconPos="left" [label]="cell.value[0]"
                                        (click)="cell.value[3] == 'C' ? cell.value[3] = 'J' :  cell.value[3] = 'C'"></button>
                                </div>
                                <div>
                                    <app-selector [textoVisible]="cell.value[3] == 'C' ? cell.value[1] : cell.value[2]"
                                        [i]="0" [selector]="cell.value"></app-selector>
                                </div>
                            </div>
                        </span>
                    </div>
                </div>
            </div>
        </div>
        <div *ngFor="let row of rowGroup.rows | slice:1; let i = index" class="table-row child collapse">
            <div (click)="selectRow(rowSelected, rowGroup.id + i)" class="table-row-wrapper hoverBlue"
                [ngClass]="{'hoverBlue2': isSelected(rowGroup.id + i), 'fixedBlue': seleccionarTodo}" [id]="rowGroup.id"
                #rowSelected>
                <div *ngIf="!posicionOcultar(-1)" class="table-row-header p-2 hidden selectedRowClass">
                </div>
                <div *ngFor="let cell of row['cells']; let z = index" class="table-cell p-2 selectedRowClass"
                    [ngClass]="{'collapse':posicionOcultar(z), 'borders-child': isPar(i)}" #cellSelected>
                    <div class="cell-wrapper selectedRowClass">
                        <span class="column-title">{{cabeceras[z+1].name}}</span>
                        <span class="w100 cell-value" *ngIf="cell.type == 'text'">{{cell.value}}</span>
                        <span class="w100 cell-value" *ngIf="cell.type == 'buttom'"><button pButton type="button"
                                iconPos="left" [label]="cell.value"></button></span>
                        <span class="w100 cell-value" *ngIf="cell.type == 'checkbox'">
                            <p-checkbox [ngModel]="validaCheck(cell.value)" binary="true">
                            </p-checkbox>
                        </span>
                        <span class="w100 cell-value" *ngIf="cell.type == 'datePicker'">
                            <app-fecha [(value)]="fechaIncorporacionDesdeSelect" [utc]="false"
                                (valueChangeSelected)="fillFechaIncorporacionDesde($event)"
                                (valueChangeInput)="fillFechaIncorporacionDesde($event)">
                            </app-fecha>
                        </span>
                        <span class="w100 cell-value" *ngIf="cell.type == 'select'">
                            <app-selector class="center" [i]="0" [textoVisible]="" [selector]="cell.value">
                            </app-selector>
                        </span>
                        <span class="w100 cell-value" *ngIf="cell.type == 'number'">{{cell.value}}</span>
                        <span class="w100 cell-value" *ngIf="cell.type == 'link'"><a>{{cell.value}}</a></span>
                        <span class="w100 cell-value" *ngIf="cell.type == '5InputSelector'">
                            <input type="text" class="form-control " pInputText size="10" [placeholder]="cell.value[0]">
                            <input type="text" class="form-control " pInputText size="10" [placeholder]="cell.value[1]">
                            <input type="text" class="form-control " pInputText size="10" [placeholder]="cell.value[2]">
                            <input type="text" class="form-control " pInputText size="10" [placeholder]="cell.value[3]">
                            <app-selector [textoVisible]="cell.value[4]" [i]="0" [selector]="cell.value"></app-selector>
                        </span>
                        <span class="w100 cell-value" *ngIf="cell.type == '2SelectorInput'">
                            <app-selector [i]="0" [selector]="cell.value"></app-selector>
                            <input type="text" class="form-control mt-2" pInputText [placeholder]="cell.value">
                        </span>
                        <span class="w100 cell-value" *ngIf="cell.type == 'buttomSelect'">
                            <div class="main-button">
                                <button pButton type="button" iconPos="left" [label]="cell.value[0]"
                                    (click)="cell.value[3] == 'C' ? cell.value[3] = 'J' :  cell.value[3] = 'C'"></button>
                            </div>
                            <app-selector [textoVisible]="cell.value[3] == 'C' ? cell.value[1] : cell.value[2]" [i]="0"
                                [selector]="cell.value"></app-selector>
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
